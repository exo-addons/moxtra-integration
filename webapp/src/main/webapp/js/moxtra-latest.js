/**
 * Moxtra JS SDK latest on May 20 2015
 */

function eventFire(e,t){if(e.fireEvent)e.fireEvent("on"+t);else{var o=document.createEvent("Event");o.initEvent(t,!1,!1),e.dispatchEvent(o)}}function triggerEvent(e,t){var o;document.createEvent?(o=document.createEvent("Event"),o.initEvent(t,!1,!1)):document.createEventObject&&(o=document.createEventObject(),o.eventType=t),o.eventName=t,e.dispatchEvent?e.dispatchEvent(o):e.fireEvent&&htmlEvents["on"+t]?e.fireEvent("on"+o.eventType,o):e[t]?e[t]():e["on"+t]&&e["on"+t]()}function loadScript(e,t){var o=document.createElement("script");o.type="text/javascript",o.readyState?o.onreadystatechange=function(){("loaded"==o.readyState||"complete"==o.readyState)&&(o.onreadystatechange=null,t&&"function"==typeof t&&t())}:o.onload=function(){t&&"function"==typeof t&&t()},o.src=e,document.getElementsByTagName("head")[0].appendChild(o)}function getInternetExplorerVersion(){var e=-1;if("Microsoft Internet Explorer"==navigator.appName){var t=navigator.userAgent,o=RegExp("MSIE ([0-9]{1,}[.0-9]{0,})");null!=o.exec(t)&&(e=parseFloat(RegExp.$1))}else if("Netscape"==navigator.appName){var t=navigator.userAgent,o=RegExp("Trident/.*rv:([0-9]{1,}[.0-9]{0,})");null!=o.exec(t)&&(e=parseFloat(RegExp.$1))}return e}"undefined"==typeof JSON&&loadScript("json.js",null),window.Moxtra_Session||(window.Moxtra_Session={});var JSONfn;JSONfn||(JSONfn={}),JSONfn.stringify=function(e){return JSON.stringify(e,function(e,t){return"function"==typeof t?""+t:t})},JSONfn.parse=function(str){return JSON.parse(str,function(key,value){return"string"!=typeof value?value:"function"==value.substring(0,8)?eval("("+value+")"):value})},Moxtra_Session.set=function(e,t){if(window.sessionStorage){var o=JSONfn.stringify(t);sessionStorage.setItem(e,o)}},Moxtra_Session.get=function(e){if(window.sessionStorage){var t=sessionStorage.getItem(e);return t?JSONfn.parse(t):null}},Moxtra_Session.remove=function(e){if(window.sessionStorage){sessionStorage.removeItem(e)}},Moxtra_Session.clear=function(){window.sessionStorage&&sessionStorage.clear()},window.Moxtra||(window.Moxtra={}),Moxtra.baseUrl="https://www.moxtra.com",Moxtra.ssoUrl=Moxtra.baseUrl+"/sp/startSSO";var htmlEvents={onload:1,onunload:1,onblur:1,onchange:1,onfocus:1,onreset:1,onselect:1,onsubmit:1,onabort:1,onkeydown:1,onkeypress:1,onkeyup:1,onclick:1,ondblclick:1,onmousedown:1,onmousemove:1,onmouseout:1,onmouseover:1,onmouseup:1};Moxtra._viewMap={},Moxtra._handlerMap={},Moxtra._invalidTokenSessionMap={},Moxtra.addListener=function(e,t,o){e.addEventListener?e.addEventListener(t,o,!1):e.attachEvent&&htmlEvents["on"+t]?e.attachEvent("on"+t,o):e["on"+t]=o},Moxtra.removeListener=function(e,t,o){e.removeEventListener?e.removeEventListener(t,o,!1):e.detachEvent&&htmlEvents["on"+t]?e.detachEvent("on"+t,o):e["on"+t]=null,console.log("remove handler: "+o)},Moxtra._JOINUrl=function(e){var t=e.joinURL;return t},Moxtra._SSOUrl=function(e,t){var o="websdk";e&&e.type&&(o=e.type);var n,r=encodeURIComponent(window.location.protocol+"//"+window.location.host);if(1==t)e&&e.email?(n=e&&e.refresh_binder_id?Moxtra.baseUrl+"/service/#meet/"+e.refresh_binder_id+"?client_id="+Moxtra.clientId+"&type="+o+"&origin="+r:Moxtra.baseUrl+"/service/#api.startMeet?client_id="+Moxtra.clientId+"&type="+o+"&origin="+r,n=n+"&email="+encodeURIComponent(e.email)):e&&e.unique_id?(n=e&&e.refresh_binder_id?Moxtra.baseUrl+"/service/#meet/"+e.refresh_binder_id+"?client_id="+Moxtra.clientId+"&type="+o+"&origin="+r:Moxtra.baseUrl+"/service/#api.startMeet?client_id="+Moxtra.clientId+"&type="+o+"&origin="+r,n=n+"&unique_id="+encodeURIComponent(e.unique_id)):n=e&&e.refresh_binder_id?Moxtra.baseUrl+"/service/#meet/"+e.refresh_binder_id+"?client_id="+Moxtra.clientId+"&type="+o+"&origin="+r:Moxtra.baseUrl+"/service/#api.startMeet?client_id="+Moxtra.clientId+"&type="+o+"&origin="+r,e&&e.schedule_binder_id&&(n=n+"&schedule_binder_id="+e.schedule_binder_id),e&&e.video&&(n+="&video=true"),e&&e.options&&(n=n+"&options="+encodeURIComponent(JSON.stringify(e.options)));else if(2==t)n=e&&e.noterefresh_binder_id?Moxtra.baseUrl+"/service/#note/"+e.noterefresh_binder_id+"?client_id="+Moxtra.clientId+"&type="+o+"&origin="+r:Moxtra.baseUrl+"/service/#record?client_id="+Moxtra.clientId+"&type="+o+"&origin="+r,e&&e.binder_id&&(n=n+"&binder_id="+e.binder_id),e&&e.page_index&&(n=n+"&page_index="+e.page_index);else if(3==t)n=e&&e.binder_id?Moxtra.baseUrl+"/service/#api.chat/"+e.binder_id:Moxtra.baseUrl+"/service/#api.startChat",n=n+"?client_id="+Moxtra.clientId+"&type="+o+"&origin="+r,e&&e.email?n=n+"&email="+encodeURIComponent(e.email):e&&e.unique_id&&(n=n+"&unique_id="+encodeURIComponent(e.unique_id)),e&&e.binder_name&&(n=n+"&binder_name="+encodeURIComponent(e.binder_name));else if(4==t)n=Moxtra.baseUrl+"/service/#login?header=0&client_id="+Moxtra.clientId+"&type="+o+"&origin="+r,e&&e.binder_id&&(n=n+"&binder_id="+e.binder_id);else if(5==t)n=Moxtra.baseUrl+"/service/#api.timeline",e&&e.binder_id&&(n=n+"/"+e.binder_id),n=n+"?client_id="+Moxtra.clientId+"&type="+o+"&origin="+r;else if(6==t)n=e&&e.binder_id?Moxtra.baseUrl+"/service/#api.annotate/"+e.binder_id:Moxtra.baseUrl+"/service/#api.startAnnotate",n=n+"?client_id="+Moxtra.clientId+"&type="+o+"&origin="+r,e&&e.binder_name&&(n=n+"&binder_name="+encodeURIComponent(e.binder_name));else if(7==t)n=Moxtra.baseUrl+"/service/#api.endMeet/"+e.session_key+"?client_id="+Moxtra.clientId+"&type="+o+"&origin="+r;else if(8==t)n=Moxtra.baseUrl+"/service/#api.video?video=true&client_id="+Moxtra.clientId+"&type="+o+"&origin="+r,e&&e.videorefresh_session_key?n=n+"&session_key="+e.videorefresh_session_key:e&&e.session_key&&(n=n+"&session_key="+e.session_key,e&&e.invisible&&(n=n+"&invisible="+e.invisible),e&&e.user_name&&(n=n+"&name="+encodeURIComponent(e.user_name))),e&&e.layout_mode&&(n=n+"&mode="+e.layout_mode);else if(9==t)n=Moxtra.baseUrl+"/service/#api.ui.timeline",n=n+"?client_id="+Moxtra.clientId+"&type="+o+"&origin="+r,e&&e.category&&(n=n+"&category="+e.category);else if(10==t)n=Moxtra.baseUrl+"/service/#api.ui.binder",e&&e.binder_id&&(n=n+"/"+e.binder_id),n=n+"?client_id="+Moxtra.clientId+"&type="+o+"&origin="+r+"&tab=tab_chat";else if(11==t){if(e&&e.viewlink_url)return e.viewlink_url+"?client_id="+Moxtra.clientId+"&type="+o+"&origin="+r+"&tab=tab_pages";n=Moxtra.baseUrl+"/service/#api.ui.binder",e&&e.binder_id&&(n=n+"/"+e.binder_id,e.page_id&&(n=n+"/"+e.page_id)),n=n+"?client_id="+Moxtra.clientId+"&type="+o+"&origin="+r+"&tab=tab_pages"}else 12==t&&(n=Moxtra.baseUrl+"/service/#api.ui.binder",e&&e.binder_id&&(n=n+"/"+e.binder_id),n=n+"?client_id="+Moxtra.clientId+"&type="+o+"&origin="+r+"&tab=tab_todo");e&&e.extension&&(n=n+"&extension="+encodeURIComponent(JSON.stringify(e.extension)));var a;return e&&e.access_token?a=n+"&access_token="+e.access_token:Moxtra.accessToken?a=n+"&access_token="+Moxtra.accessToken:Moxtra.appKey?Moxtra._barlogin?a=n:(a=Moxtra.ssoUrl+"?idpid="+Moxtra.appKey+"&target="+encodeURIComponent(n),Moxtra.partnerId?a+="&partnerid="+Moxtra.partnerId:Moxtra.orgId&&(a+="&orgid="+Moxtra.orgId)):a=e&&e.token?Moxtra.baseUrl+"/login?token="+encodeURIComponent(e.token)+"&loginUrl="+encodeURIComponent(e.loginUrl)+"&type="+o+"&client_id="+Moxtra.clientId+"&origin="+r+"&backUrl="+encodeURIComponent(n):n,a},Moxtra._parseURL=function(e){for(var t,o=/[?#&]([^=#]+)=([^&#]*)/g,n={};t=o.exec(e);)n[t[1]]=t[2];return n},Moxtra._handleMessageFromChatEvent=function(e,t){switch(e.action){case"end":return Moxtra._popupbychat&&Moxtra._popupbychat.close(),Moxtra._popupbychat=null,"function"==typeof t.end?t.end(e):"function"==typeof t.end_meet?t.end_meet(e):Moxtra._meet&&document.createEvent&&(m=document.createEvent("Event"),m.initEvent("MeetEnd",!1,!1),Moxtra._meet.dispatchEvent(m)),!0;case"leave":case"leave_as_ended":return Moxtra._popupbychat&&Moxtra._popupbychat.close(),Moxtra._popupbychat=null,"function"==typeof t.exit?t.exit(e):"function"==typeof t.exit_meet?t.exit_meet(e):Moxtra._meet&&document.createEvent&&(m=document.createEvent("Event"),m.initEvent("MeetExit",!1,!1),Moxtra._meet.dispatchEvent(m)),!0;case"save_note":return Moxtra._notepopupbychat&&Moxtra._notepopupbychat.close(),Moxtra._notepopupbychat=null,"function"==typeof t.save_note?t.save_note(e):Moxtra._note&&document.createEvent&&(m=document.createEvent("Event"),m.initEvent("NoteSave",!1,!1),m.destination_binder_id=e.destination_binder_id,m.download_url=e.download_url,m.share_url=e.share_url,Moxtra._note.dispatchEvent(m)),!0;case"cancel_note":return Moxtra._notepopupbychat&&Moxtra._notepopupbychat.close(),Moxtra._notepopupbychat=null,"function"==typeof t.cancel?t.cancel(e):"function"==typeof t.cancel_note?t.cancel_note(e):Moxtra._note&&document.createEvent&&(m=document.createEvent("Event"),m.initEvent("NoteCancel",!1,!1),Moxtra._note.dispatchEvent(m)),!0;case"invalidToken":var o=Moxtra._invalidTokenSessionMap[e.session_id];return o||(Moxtra._invalidTokenSessionMap[e.session_id]=e.session_id,Moxtra._handleInvalidToken(e)),!0;default:return Moxtra._handleMessageEvent(e,t)}},Moxtra._handleViewMessageEvent=function(e,t,o){switch(e.action){case"fail":return"function"==typeof t.error?(t.error(e),!1):!1;case"view":return"chat"===o?"function"==typeof t.start_chat&&t.start_chat(e):"page"===o?"function"==typeof t.start_page&&t.start_page(e):"todo"===o?"function"==typeof t.start_todo&&t.start_todo(e):"timeline"===o&&"function"==typeof t.view_binder&&t.view_binder(e),!1;case"view_share_link":return"function"==typeof t.view_share_link&&t.view_share_link(e),!1;case"request_view_binder":return"function"==typeof t.request_view_binder&&t.request_view_binder(e),!1;case"view_binder_page":return"function"==typeof t.view_binder_page&&t.view_binder_page(e),!1;case"list":return"function"==typeof t.start_timeline&&t.start_timeline(e),!1;case"request_note":return t.autostart_note?(t.from_chat=!0,t.iframe=!1,t.binder_id=e.binder_id,t.page_index=e.page_index,Moxtra.note(t)):"function"==typeof t.request_note&&t.request_note(e),!1;case"share":return"function"==typeof t.share&&t.share(e),!1;case"invalidToken":if(t)if(t.iframe&&t.iframe===!0){var n;t.tagid4iframe&&(n=document.getElementById(t.tagid4iframe),n&&t.handle_iframe&&(n.removeChild(t.handle_iframe),t.handle_iframe=null)),n||t.handle_iframe&&(document.body.removeChild(t.handle_iframe),t.handle_iframe=null)}else t.handle_popup&&(t.handle_popup.close(),t.handle_popup=null);var r=Moxtra._invalidTokenSessionMap[e.session_id];return r||(Moxtra._invalidTokenSessionMap[e.session_id]=e.session_id,Moxtra._handleInvalidToken(e)),!0;case"feed_update_self":return"function"==typeof t.publish_feed&&t.publish_feed(e),!1;case"feed_update":return"function"==typeof t.receive_feed&&t.receive_feed(e),!1}if(t.extension&&t.extension.menus&&t.extension.menus[0].add_page)for(var a=0;a<t.extension.menus[0].add_page.length;a++){var i=t.extension.menus[0].add_page[a];if(e.action==i.menu_name){"function"==typeof t.add_page?t.add_page(e):document.createEvent&&(m=document.createEvent("Event"),m.initEvent(i.menu_name,!1,!1),m.binder_id=e.binder_id,m.session_key=e.session_key,m.meet_id=e.meet_id,m.session_id=e.session_id,window.dispatchEvent(m));break}}if(t.extension&&t.extension.menus&&t.extension.menus[0].page_action)for(var a=0;a<t.extension.menus[0].page_action.length;a++){var i=t.extension.menus[0].page_action[a];if(e.action==i.menu_name){"function"==typeof t.page_action?t.page_action(e):document.createEvent&&(m=document.createEvent("Event"),m.initEvent("page_action",!1,!1),m.action=e.action,m.binder_id=e.binder_id,m.session_id=e.session_id,m.download_url=e.download_url,window.dispatchEvent(m));break}}return!1},Moxtra._handleChatMessageEvent=function(e,t,o){switch(e.action){case"fail":return"function"==typeof t.error?(t.error(e),!1):(o?Moxtra._chat&&document.createEvent&&(m=document.createEvent("Event"),m.initEvent("ChatError",!1,!1),m.error_code=e.error_code,m.error_message=e.error_message,Moxtra._chat.dispatchEvent(m)):Moxtra._timeline&&document.createEvent&&(m=document.createEvent("Event"),m.initEvent("TimelineError",!1,!1),m.error_code=e.error_code,m.error_message=e.error_message,Moxtra._timeline.dispatchEvent(m)),!1);case"view":return o?"function"==typeof t.start_chat?t.start_chat(e):Moxtra._chat&&document.createEvent&&(m=document.createEvent("Event"),m.initEvent("ChatStart",!1,!1),m.binder_id=e.binder_id,m.session_id=e.session_id,Moxtra._chat.dispatchEvent(m)):"function"==typeof t.view_binder?t.view_binder(e):Moxtra._timeline&&document.createEvent&&(m=document.createEvent("Event"),m.initEvent("BinderView",!1,!1),m.binder_id=e.binder_id,m.session_id=e.session_id,Moxtra._timeline.dispatchEvent(m)),!1;case"list":return"function"==typeof t.start_timeline?t.start_timeline(e):Moxtra._timeline&&document.createEvent&&(m=document.createEvent("Event"),m.initEvent("TimelineStart",!1,!1),m.session_id=e.session_id,m.binder_id=e.binder_id,Moxtra._timeline.dispatchEvent(m)),!1;case"create_binder":return"function"==typeof t.create_binder?t.create_binder(e):Moxtra._timeline&&document.createEvent&&(m=document.createEvent("Event"),m.initEvent("BinderCreate",!1,!1),m.session_id=e.session_id,m.binder_id=e.binder_id,Moxtra._timeline.dispatchEvent(m)),!1;case"delete_binder":return"function"==typeof t.delete_binder?t.delete_binder(e):Moxtra._timeline&&document.createEvent&&(m=document.createEvent("Event"),m.initEvent("BinderDelete",!1,!1),m.session_id=e.session_id,m.binder_id=e.binder_id,Moxtra._timeline.dispatchEvent(m)),!1;case"leave_binder":return"function"==typeof t.leave_binder?t.leave_binder(e):(Moxtra._timeline&&document.createEvent&&(m=document.createEvent("Event"),m.initEvent("BinderUserLeave",!1,!1),m.session_id=e.session_id,m.binder_id=e.binder_id,Moxtra._timeline.dispatchEvent(m)),Moxtra._chat&&document.createEvent&&(m.initEvent("BinderUserLeave",!1,!1),m.session_id=e.session_id,m.binder_id=e.binder_id,Moxtra._chat.dispatchEvent(m))),!1;case"remove_binder_user":return"function"==typeof t.remove_binder_user?t.remove_binder_user(e):(Moxtra._timeline&&document.createEvent&&(m=document.createEvent("Event"),m.initEvent("BinderUserRemove",!1,!1),m.session_id=e.session_id,m.binder_id=e.binder_id,Moxtra._timeline.dispatchEvent(m)),Moxtra._chat&&document.createEvent&&(m.initEvent("BinderUserRemove",!1,!1),m.session_id=e.session_id,m.binder_id=e.binder_id,Moxtra._chat.dispatchEvent(m))),!1;case"request_meet":return t.autostart_meet?(t.from_chat=!0,t.iframe=!1,Moxtra.meet(t)):"function"==typeof t.request_meet?t.request_meet(e):o?Moxtra._chat&&document.createEvent&&(m=document.createEvent("Event"),m.initEvent("MeetRequest",!1,!1),m.binder_id=e.binder_id,Moxtra._chat.dispatchEvent(m)):Moxtra._timeline&&document.createEvent&&(m=document.createEvent("Event"),m.initEvent("MeetRequest",!1,!1),m.binder_id=e.binder_id,Moxtra._timeline.dispatchEvent(m)),!1;case"request_note":return t.autostart_note?(t.from_chat=!0,t.iframe=!1,t.binder_id=e.binder_id,t.page_index=e.page_index,Moxtra.note(t)):"function"==typeof t.request_note?t.request_note(e):o?Moxtra._chat&&document.createEvent&&(m=document.createEvent("Event"),m.initEvent("NoteRequest",!1,!1),Moxtra._chat.dispatchEvent(m)):Moxtra._timeline&&document.createEvent&&(m=document.createEvent("Event"),m.initEvent("NoteRequest",!1,!1),Moxtra._timeline.dispatchEvent(m)),!1;case"invite":return"function"==typeof t.invite_member?t.invite_member(e):(Moxtra._chat||Moxtra._timeline)&&document.createEvent&&(m=document.createEvent("Event"),m.initEvent("MemberInvite",!1,!1),m.binder_id=e.binder_id,Moxtra._chat?Moxtra._chat.dispatchEvent(m):Moxtra._timeline.dispatchEvent(m)),!1;case"share":return"function"==typeof t.share&&t.share(e),!1;case"invalidToken":if(t)if(t.iframe&&t.iframe===!0){var n;t.tagid4iframe&&(n=document.getElementById(t.tagid4iframe),n&&t.handle_iframe&&(n.removeChild(t.handle_iframe),t.handle_iframe=null)),n||t.handle_iframe&&(document.body.removeChild(t.handle_iframe),t.handle_iframe=null)}else t.handle_popup&&(t.handle_popup.close(),t.handle_popup=null);var r=Moxtra._invalidTokenSessionMap[e.session_id];return r||(Moxtra._invalidTokenSessionMap[e.session_id]=e.session_id,Moxtra._handleInvalidToken(e)),!0;case"feed_update_self":return"function"==typeof t.publish_feed&&t.publish_feed(e),!1;case"feed_update":return"function"==typeof t.receive_feed&&t.receive_feed(e),!1}if(t.extension&&t.extension.menus&&t.extension.menus[0].add_page)for(var a=0;a<t.extension.menus[0].add_page.length;a++){var i=t.extension.menus[0].add_page[a];if(e.action==i.menu_name){"function"==typeof t.add_page?t.add_page(e):document.createEvent&&(m=document.createEvent("Event"),m.initEvent(i.menu_name,!1,!1),m.binder_id=e.binder_id,m.session_key=e.session_key,m.meet_id=e.meet_id,m.session_id=e.session_id,window.dispatchEvent(m));break}}if(t.extension&&t.extension.menus&&t.extension.menus[0].page_action)for(var a=0;a<t.extension.menus[0].page_action.length;a++){var i=t.extension.menus[0].page_action[a];if(e.action==i.menu_name){"function"==typeof t.page_action?t.page_action(e):document.createEvent&&(m=document.createEvent("Event"),m.initEvent("page_action",!1,!1),m.action=e.action,m.binder_id=e.binder_id,m.session_id=e.session_id,m.download_url=e.download_url,window.dispatchEvent(m));break}}return!1},Moxtra._handleMessageEvent=function(e,t){switch(e.action){case"start":case"join":if(Moxtra.session_key=e.session_key,Moxtra.meet_id=e.meet_id,Moxtra.session_id=e.session_id,Moxtra.access_token=t.access_token,Moxtra.joinURL=Moxtra.getJoinMeetURL(e.session_key?e.session_key:e.meet_id,t.user_name,"websdk",t.access_token,t.extension,t.invisible,t.video),t.iframe&&t.iframe===!0){if(!t.joinURL)if(t.no_refresh){t.session_key=e.session_key;var o=Moxtra._SSOUrl(t,7);Moxtra_Session.set("meet_endurl",o)}else t.from_chat||(t.refresh_binder_id=e.binder_id,t.session_key=e.session_key,Moxtra_Session.set("meet_refresh",t))}else Moxtra_Session.remove("meet_refresh");return"function"==typeof t.success?t.success(e):"function"==typeof t.start_meet?t.start_meet(e):Moxtra._meet&&document.createEvent&&(m=document.createEvent("Event"),m.initEvent("MeetSuccess",!1,!1),m.session_key=e.session_key,m.meet_id=e.meet_id,m.session_id=e.session_id,Moxtra._meet.dispatchEvent(m)),!1;case"resume_meet":return Moxtra.session_key=e.session_key,Moxtra.meet_id=e.meet_id,"function"==typeof t.resume_meet?t.resume_meet(e):Moxtra._meet&&document.createEvent&&(m=document.createEvent("Event"),m.initEvent("MeetResume",!1,!1),m.session_key=e.session_key,m.meet_id=e.meet_id,m.session_id=e.session_id,Moxtra._meet.dispatchEvent(m)),!1;case"end":if(t)if(t.iframe&&t.iframe===!0){var n;t.tagid4iframe&&(n=document.getElementById(t.tagid4iframe),n&&n.removeChild(Moxtra._iframe)),n||document.body.removeChild(Moxtra._iframe),Moxtra._iframe=null}else Moxtra._popup&&Moxtra._popup.close(),Moxtra._popup=null;return Moxtra.session_id=null,Moxtra.session_key=null,Moxtra_Session.remove("meet_refresh"),"function"==typeof t.end?t.end(e):"function"==typeof t.end_meet?t.end_meet(e):Moxtra._meet&&document.createEvent&&(m=document.createEvent("Event"),m.initEvent("MeetEnd",!1,!1),Moxtra._meet.dispatchEvent(m)),!0;case"leave":case"leave_as_ended":if(t)if(t.iframe&&t.iframe===!0){var n;t.tagid4iframe&&(n=document.getElementById(t.tagid4iframe),n&&n.removeChild(Moxtra._iframe)),n||document.body.removeChild(Moxtra._iframe),Moxtra._iframe=null}else Moxtra._popup&&Moxtra._popup.close(),Moxtra._popup=null;return Moxtra.session_id=null,Moxtra.session_key=null,Moxtra_Session.remove("meet_refresh"),"function"==typeof t.exit?t.exit(e):"function"==typeof t.exit_meet?t.exit_meet(e):Moxtra._meet&&document.createEvent&&(m=document.createEvent("Event"),m.initEvent("MeetExit",!1,!1),Moxtra._meet.dispatchEvent(m)),!0;case"invite":return e.session_key?"function"==typeof t.invite?t.invite(e):"function"==typeof t.invite_meet?t.invite_meet(e):Moxtra._meet&&document.createEvent&&(m=document.createEvent("Event"),m.initEvent("MeetInvite",!1,!1),m.binder_id=e.binder_id,m.session_key=e.session_key,m.meet_id=e.meet_id,m.session_id=e.session_id,Moxtra._meet.dispatchEvent(m)):"function"==typeof t.invite_member?t.invite_member(e):(Moxtra._chat||Moxtra._timeline)&&document.createEvent&&(m=document.createEvent("Event"),m.initEvent("MemberInvite",!1,!1),m.binder_id=e.binder_id,Moxtra._chat?Moxtra._chat.dispatchEvent(m):Moxtra._timeline.dispatchEvent(m)),!1;case"invited":return"function"==typeof t.invited?t.invited(e):"function"==typeof t.invited_meet?t.invited_meet(e):Moxtra._meet&&document.createEvent&&(m=document.createEvent("Event"),m.initEvent("MemberInvited",!1,!1),m.binder_id=e.binder_id,m.session_key=e.session_key,m.meet_id=e.meet_id,m.session_id=e.session_id,Moxtra._meet.dispatchEvent(m)),!1;case"save":return"function"==typeof t.save?t.save(e):"function"==typeof t.save_meet?t.save_meet(e):Moxtra._meet&&document.createEvent&&(m=document.createEvent("Event"),m.initEvent("MeetSaved",!1,!1),m.binder_id=e.binder_id,m.session_key=e.session_key,m.meet_id=e.meet_id,m.session_id=e.session_id,Moxtra._meet.dispatchEvent(m)),!1;case"share":return"function"==typeof t.share&&t.share(e),!1;case"start_note":return t.from_chat||(t.noterefresh_binder_id=e.binder_id,Moxtra_Session.set("note_refresh",t)),"function"==typeof t.start_note?t.start_note(e):Moxtra._note&&document.createEvent&&(m=document.createEvent("Event"),m.initEvent("NoteStart",!1,!1),m.session_key=e.session_key,m.meet_id=e.meet_id,m.session_id=e.session_id,Moxtra._note.dispatchEvent(m)),!1;case"save_note":if(t)if(t.iframe&&t.iframe===!0){var n;t.tagid4iframe&&(n=document.getElementById(t.tagid4iframe),n&&n.removeChild(Moxtra._noteiframe)),n||document.body.removeChild(Moxtra._noteiframe),Moxtra._noteiframe=null}else Moxtra._notepopup&&Moxtra._notepopup.close(),Moxtra._notepopup=null;return Moxtra_Session.remove("note_refresh"),"function"==typeof t.save_note?t.save_note(e):Moxtra._note&&document.createEvent&&(m=document.createEvent("Event"),m.initEvent("NoteSave",!1,!1),m.destination_binder_id=e.destination_binder_id,m.download_url=e.download_url,m.share_url=e.share_url,Moxtra._note.dispatchEvent(m)),!0;case"fail":if("function"==typeof t.error){if(t.error(e),412==t.error_code||404==t.error_code){if(t.iframe&&t.iframe===!0){var n;t.tagid4iframe&&(n=document.getElementById(t.tagid4iframe),n&&n.removeChild(Moxtra._iframe)),n||document.body.removeChild(Moxtra._iframe),Moxtra._iframe=null}else Moxtra._popup&&Moxtra._popup.close(),Moxtra._popup=null;return Moxtra.session_id=null,Moxtra.session_key=null,Moxtra_Session.remove("meet_refresh"),"function"==typeof t.exit?t.exit(e):"function"==typeof t.exit_meet?t.exit_meet(e):Moxtra._meet&&document.createEvent&&(m=document.createEvent("Event"),m.initEvent("MeetExit",!1,!1),Moxtra._meet.dispatchEvent(m)),!0}return!1}return e.is_chat?(m=document.createEvent("Event"),m.initEvent("ChatError",!1,!1),m.error_code=e.error_code,m.error_message=e.error_message,Moxtra._chat.dispatchEvent(m),!1):(Moxtra.session_id&&e.session_id===Moxtra.session_id?Moxtra_meet&&document.createEvent&&(m=document.createEvent("Event"),m.initEvent("MeetError",!1,!1),m.error_code=e.error_code,m.error_message=e.error_message,Moxtra._meet.dispatchEvent(m)):Moxtra_note&&document.createEvent&&(m=document.createEvent("Event"),m.initEvent("NoteError",!1,!1),m.error_code=e.error_code,m.error_message=e.error_message,Moxtra._note.dispatchEvent(m)),!1);case"cancel_note":if(t)if(t.iframe&&t.iframe===!0){var n;t.tagid4iframe&&(n=document.getElementById(t.tagid4iframe),n&&n.removeChild(Moxtra._noteiframe)),n||document.body.removeChild(Moxtra._noteiframe),Moxtra._noteiframe=null}else Moxtra._notepopup&&Moxtra._notepopup.close(),Moxtra._notepopup=null;return Moxtra_Session.remove("note_refresh"),"function"==typeof t.cancel?t.cancel(e):"function"==typeof t.cancel_note?t.cancel_note(e):Moxtra._note&&document.createEvent&&(m=document.createEvent("Event"),m.initEvent("NoteCancel",!1,!1),Moxtra._note.dispatchEvent(m)),!0;case"start_annotate":return"function"==typeof t.start_annotate?t.start_annotate(e):Moxtra._annotate&&document.createEvent&&(m=document.createEvent("Event"),m.initEvent("AnnotateStart",!1,!1),m.session_id=e.session_id,m.binder_id=e.binder_id,Moxtra._annotate.dispatchEvent(m)),!1;case"stop_annotate":if(t)if(t.iframe&&t.iframe===!0){var n;t.tagid4iframe&&(n=document.getElementById(t.tagid4iframe),n&&n.removeChild(Moxtra._annotateiframe)),n||document.body.removeChild(Moxtra._annotateiframe),Moxtra._annotateiframe=null}else Moxtra._annotatepopup&&Moxtra._annotatepopup.close(),Moxtra._annotatepopup=null;return"function"==typeof t.stop_annotate?t.stop_annotate(e):Moxtra._annotate&&document.createEvent&&(m=document.createEvent("Event"),m.initEvent("AnnotateStop",!1,!1),m.download_url=e.download_url,m.share_url=e.share_url,m.binder_id=e.binder_id,Moxtra._annotate.dispatchEvent(m)),!0;case"invalidToken":if(t)if(t.iframe&&t.iframe===!0){var n;t.tagid4iframe&&(n=document.getElementById(t.tagid4iframe),n&&Moxtra._annotateiframe&&(n.removeChild(Moxtra._annotateiframe),Moxtra._annotateiframe=null)),n||Moxtra._annotateiframe&&(document.body.removeChild(Moxtra._annotateiframe),Moxtra._annotateiframe=null)}else Moxtra._annotatepopup&&(Moxtra._annotatepopup.close(),Moxtra._annotatepopup=null);var r=Moxtra._invalidTokenSessionMap[e.session_id];return r||(Moxtra._invalidTokenSessionMap[e.session_id]=e.session_id,Moxtra._handleInvalidToken(e)),!0}if(t.extension&&t.extension.menus&&t.extension.menus[0].add_page)for(var a=0;a<t.extension.menus[0].add_page.length;a++){var i=t.extension.menus[0].add_page[a];if(e.action==i.menu_name){"function"==typeof t.add_page?t.add_page(e):document.createEvent&&(m=document.createEvent("Event"),m.initEvent(i.menu_name,!1,!1),m.binder_id=e.binder_id,m.session_key=e.session_key,m.meet_id=e.meet_id,m.session_id=e.session_id,window.dispatchEvent(m));break}}if(t.extension&&t.extension.menus&&t.extension.menus[0].page_action)for(var a=0;a<t.extension.menus[0].page_action.length;a++){var i=t.extension.menus[0].page_action[a];if(e.action==i.menu_name){"function"==typeof t.page_action?t.page_action(e):document.createEvent&&(m=document.createEvent("Event"),m.initEvent("page_action",!1,!1),m.action=e.action,m.binder_id=e.binder_id,m.session_id=e.session_id,m.download_url=e.download_url,window.dispatchEvent(m));break}}return!1},Moxtra._handleVideoMessageEvent=function(e,t){switch(e.action){case"video_joined":return Moxtra.video_session_key=e.session_key,Moxtra.video_access_token=t.access_token,t.no_refresh||(t.videorefresh_session_key=e.session_key,Moxtra_Session.set("video_refresh",t)),"function"==typeof t.start_video?t.start_video(e):Moxtra._video&&document.createEvent&&(m=document.createEvent("Event"),m.initEvent("VideoStart",!1,!1),m.session_key=e.session_key,m.session_id=e.session_id,m.binder_id=e.binder_id,Moxtra._video.dispatchEvent(m)),!1;case"end":case"leave":case"leave_as_ended":case"video_left":if(t)if(t.iframe&&t.iframe===!0){var o;t.tagid4iframe&&(o=document.getElementById(t.tagid4iframe),o&&o.removeChild(Moxtra._videoiframe)),o||document.body.removeChild(Moxtra._videoiframe),Moxtra._videoiframe=null}else Moxtra._videopopup&&Moxtra._videopopup.close(),Moxtra._videopopup=null;return Moxtra.video_session_key=null,Moxtra.video_access_token=null,Moxtra_Session.remove("video_refresh"),"function"==typeof t.end_video?t.end_video(e):Moxtra._video&&document.createEvent&&(m=document.createEvent("Event"),m.initEvent("VideoEnd",!1,!1),m.session_id=e.session_id,Moxtra._video.dispatchEvent(m)),!0;case"video_broadcasted":return"function"==typeof t.camera_on?t.camera_on(e):Moxtra._video&&document.createEvent&&(m=document.createEvent("Event"),m.initEvent("CameraOn",!1,!1),m.session_id=e.session_id,Moxtra._video.dispatchEvent(m)),!1;case"video_unbroadcasted":return"function"==typeof t.camera_off?t.camera_off(e):Moxtra._video&&document.createEvent&&(m=document.createEvent("Event"),m.initEvent("CameraOff",!1,!1),m.session_id=e.session_id,Moxtra._video.dispatchEvent(m)),!1;case"fail":return"function"==typeof t.error?(t.error(e),!1):e.is_chat?(m=document.createEvent("Event"),m.initEvent("ChatError",!1,!1),m.error_code=e.error_code,m.error_message=e.error_message,Moxtra._chat.dispatchEvent(m),!1):!1;case"invalidToken":var n=Moxtra._invalidTokenSessionMap[e.session_id];return n||(Moxtra._invalidTokenSessionMap[e.session_id]=e.session_id,Moxtra._handleInvalidToken(e)),!0}return!1},Moxtra._ajax=function(e,t,o,n,r){var a={};if(o)for(var i in o)a[i]=o[i];jQuery.ajax({type:e,url:t,dataType:"jsonp",data:JSON.stringify(a),cache:!1,jsonpCallback:"verifyme",success:function(e){return"RESPONSE_SUCCESS"!=e.code&&r?void r(e):void(n&&n(e.object))},error:function(e){if(r)try{r(JSON.parse(e.responseText))}catch(t){}},beforeSend:function(e){e.setRequestHeader("Content-type","application/json")},contentType:"application/json;"})},Moxtra._getMembers=function(e,t,o){var n=[];Moxtra._ajax("GET","/board/"+e,null,function(e){var o=e.board.users;if(o)for(var r=0;r<o.length;r++){var a={};a.sequence=o[r].sequence,a.id=o[r].user.id,a.name=o[r].user.name,a.email=o[r].user.email,a.email_verified=o[r].user.email_verified,a.first_name=o[r].user.first_name,a.last_name=o[r].user.last_name,n.push(a)}t&&"function"==typeof t&&t(n)},function(e){o&&"function"==typeof o&&o(e.message)})},Moxtra.setup=function(e){if(!e)throw"You must pass in options";if(e.clientId&&(Moxtra.clientId=e.clientId),!Moxtra.clientId)throw"You have to set clientId";if(!(e&&e.uniqueid&&e.signature&&e.timestamp))throw"You have to set uniqueid, signature, and timestamp";var t;t=Moxtra.baseUrl+"/oauthapi/token?client_id="+Moxtra.clientId+"&uniqueid="+encodeURIComponent(e.uniqueid)+"&timestamp="+e.timestamp+"&signature="+e.signature,e.firstname&&(t+="&firstname="+encodeURIComponent(e.firstname)),e.lastname&&(t+="&lastname="+encodeURIComponent(e.lastname)),e.orgid&&(t+="&orgid="+encodeURIComponent(e.orgid)),e.pictureurl&&(t+="&pictureurl="+encodeURIComponent(e.pictureurl)),e.timezone&&(t+="&timezone="+encodeURIComponent(e.timezone)),e.plancode&&(t+="&plancode="+encodeURIComponent(e.plancode)),e.division&&(t+="&division="+encodeURIComponent(e.division)),e.department&&(t+="&department="+encodeURIComponent(e.department)),jQuery.ajax({type:"GET",url:t,dataType:"jsonp",cache:!1,jsonpCallback:"verifyme",success:function(t){if(t.access_token)"function"==typeof e.get_accesstoken&&e.get_accesstoken(t);else if("error"==t.status&&"function"==typeof e.error){var o={};o.error_code="RESPONSE_ERROR",o.error_message=t.message,e.error(o)}},error:function(t,o,n){if("function"==typeof e.error){var r={};r.error_code="RESPONSE_ERROR",r.error_message=n,e.error(r)}}})},Moxtra.logout=function(){Moxtra.baseUrl.indexOf("grouphour.com")<0?(document.cookie="c_user=; path=/; domain=www.moxtra.com; expires="+new Date(0).toUTCString(),document.cookie="token=; path=/; domain=www.moxtra.com; expires="+new Date(0).toUTCString(),document.cookie="sessionid=; path=/; domain=www.moxtra.com; expires="+new Date(0).toUTCString()):(document.cookie="c_user=; path=/; domain=www.grouphour.com; expires="+new Date(0).toUTCString(),document.cookie="token=; path=/; domain=www.grouphour.com; expires="+new Date(0).toUTCString(),document.cookie="sessionid=; path=/; domain=www.grouphour.com; expires="+new Date(0).toUTCString())},Moxtra.init=function(e){if("production"===e.mode)Moxtra.baseUrl="https://www.moxtra.com";else if("sandbox"===e.mode)Moxtra.baseUrl="https://sandbox.moxtra.com";else{if("debug"!==e.mode)return void alert("Please specify mode!");Moxtra.baseUrl="https://www.grouphour.com"}return e.client_id?(Moxtra.clientId=e.client_id,e.idp_id&&(Moxtra.appKey=e.idp_id),Moxtra.ssoUrl="idpdemo"==Moxtra.appKey?Moxtra.baseUrl+"/sp/spdemo":Moxtra.baseUrl+"/sp/startSSO",e.partner_id&&(Moxtra.partnerId=e.partner_id),e.org_id&&(Moxtra.orgId=e.org_id),e.access_token&&(Moxtra.accessToken=e.access_token),void("function"==typeof e.invalid_token&&(Moxtra._handleInvalidToken=e.invalid_token))):void alert("Please specify client_id!")},Moxtra._createWidgetElement=function(e,t,o,n){var r,a;return r=document.createElement("iframe"),r.src=e,r.setAttribute("frameborder","0"),r.setAttribute("allowtransparency","true"),t.scroll&&(r.style.overflow="scroll"),r.style.backgroundColor="transparent",r.style.width="100%",r.style.height="100%",t.iframe===!0&&t.tagid4iframe&&(a=document.getElementById(t.tagid4iframe),a&&t.border===!1&&(r.style.width=t.iframewidth?t.iframewidth:o?"850px":n?"330px":"1024px",r.style.height=t.iframeheight?t.iframeheight:o?"500px":"768px")),r.setAttribute("allowFullScreen",""),r.setAttribute("webkitAllowFullScreen",""),r.setAttribute("mozallowfullscreen",""),r.style.border="none",t.scroll&&(r.style.scrolling="yes"),r
},Moxtra._createSimpleDivElement=function(e,t,o,n){var r=document.createElement("div");return r.style.width=e.iframewidth?e.iframewidth:o,r.style.height=e.iframeheight?e.iframeheight:n,r.style.margin="10px 0px",r.style.border="1px solid #ACACAC",r.style.boxShadow="rgba(0, 0, 0, .2) 0px 4px 16px",r.appendChild(t),r},Moxtra._createDivElement=function(e,t,o,n){var r=document.createElement("div");r.style.left=r.style.right=r.style.top=r.style.bottom="0px",r.style.zIndex="1000";var a=document.createElement("div");a.style.left=a.style.right=a.style.top=a.style.bottom="0px",a.style.backgroundColor="rgb(160, 160, 160)",a.style.opacity="0.2",a.style.filter="progid:DXImageTransform.Microsoft.Alpha(Opacity=20)";var i=Moxtra._createSimpleDivElement(e,t,o,n);return r.appendChild(a),r.appendChild(i),r},Moxtra._createHiddenIframe=function(e){var t;return t=document.createElement("iframe"),t.src=e,t.setAttribute("frameborder","0"),t.style.width="100%",t.style.height="0",t.style.border="none",t},Moxtra.joinMeet=function(e){if(!e)throw"You must pass in options";var t="websdk";if(e.type&&(t=e.type),e.appKey&&(Moxtra.appKey=e.appKey),e.partnerId&&(Moxtra.partnerId=e.partnerId),e.orgId&&(Moxtra.orgId=e.orgId),e.clientId&&(Moxtra.clientId=e.clientId),(e.session_key||e.meet_id)&&(e.joinURL=Moxtra.getJoinMeetURL(e.session_key?e.session_key:e.meet_id,e.user_name,t,e.access_token,e.extension,e.invisible,e.video)),!e.joinURL)throw"You must pass in session_key";Moxtra.meet(e)},Moxtra.endVideo=function(){var e=Moxtra._getMeetURL(!0,!1);e&&(ef=function(){var t=function(e){e.origin==Moxtra.baseUrl&&(Moxtra.removeListener(Moxtra._videohiddeniframe,"message",t),document.body.removeChild(Moxtra._videohiddeniframe),Moxtra._videohiddeniframe=null)},o=Moxtra._createHiddenIframe(e);Moxtra.addListener(o,"message",t),document.body.appendChild(o),Moxtra._videohiddeniframe=o})()},Moxtra.leaveVideo=function(){var e=Moxtra._getMeetURL(!1,!1);e&&(ef=function(){var t=function(e){e.origin==Moxtra.baseUrl&&(Moxtra.removeListener(Moxtra._videohiddeniframe,"message",t),document.body.removeChild(Moxtra._videohiddeniframe),Moxtra._videohiddeniframe=null)},o=Moxtra._createHiddenIframe(e);Moxtra.addListener(o,"message",t),document.body.appendChild(o),Moxtra._videohiddeniframe=o})()},Moxtra.leaveMeet=function(){var e=Moxtra._getMeetURL(!1,!0);e&&(ef=function(){var t=function(e){e.origin==Moxtra.baseUrl&&(Moxtra.removeListener(Moxtra._meethiddeniframe,"message",t),document.body.removeChild(Moxtra._meethiddeniframe),Moxtra._meethiddeniframe=null)},o=Moxtra._createHiddenIframe(e);Moxtra.addListener(o,"message",t),document.body.appendChild(o),Moxtra._meethiddeniframe=o})()},Moxtra.endMeet=function(e){(e||(e=Moxtra._getMeetURL(!0,!0)))&&(ef=function(){var t=function(e){e.origin==Moxtra.baseUrl&&(Moxtra.removeListener(Moxtra._hiddeniframe,"message",t),document.body.removeChild(Moxtra._hiddeniframe),Moxtra._hiddeniframe=null,Moxtra_Session.remove("meet_endurl"))},o=Moxtra._createHiddenIframe(e);Moxtra.addListener(o,"message",t),document.body.appendChild(o),Moxtra._hiddeniframe=o})()},Moxtra.meet=function(e){var t,o,n,r,a,i,d,s;if(!e)throw"You must pass in options";var c=Moxtra_Session.get("meet_refresh");if(c){if(!e.refresh_binder_id)return}else if(Moxtra._iframe)return;e.joinURL&&(Moxtra.joinURL=e.joinURL),e.appKey&&(Moxtra.appKey=e.appKey),e.partnerId&&(Moxtra.partnerId=e.partnerId),e.orgId&&(Moxtra.orgId=e.orgId),e.clientId&&(Moxtra.clientId=e.clientId),(ef=function(){if("Microsoft Internet Explorer"==navigator.appName){var m=document.getElementById("moxtraButton"),l=function(){data=document.getElementById("moxtraCommData").value;var t=!1;t=e&&e.from_chat&&e.from_chat===!0?Moxtra._handleMessageFromChatEvent(JSON.parse(data),e):Moxtra._handleMessageEvent(JSON.parse(data),e),t&&Moxtra.removeListener(m,"click",l)};Moxtra.addListener(m,"click",l)}else{var _=function(t){if(t.origin==Moxtra.baseUrl){var o=!1;o=e&&e.from_chat&&e.from_chat===!0?Moxtra._handleMessageFromChatEvent(JSON.parse(t.data),e):Moxtra._handleMessageEvent(JSON.parse(t.data),e),o&&Moxtra.removeListener(window,"message",_)}};Moxtra.addListener(window,"message",_)}if(e.iframe&&e.iframe===!0){s=Moxtra._createWidgetElement(e.joinURL?Moxtra._JOINUrl(e):Moxtra._SSOUrl(e,1),e,!1,!1);var p;if(e.tagid4iframe)if(p=document.getElementById(e.tagid4iframe))e.border===!1?(p.appendChild(s),Moxtra._iframe=s):(o=Moxtra._createSimpleDivElement(e,s,"1024px","768px"),p.appendChild(o),Moxtra._iframe=o);else if(c)return Moxtra_Session.remove("meet_refresh"),void s.remove();p||(r=Moxtra._createDivElement(e,s,"1024px","768px"),document.body.appendChild(r),Moxtra._iframe=r,r.scrollIntoView(!0))}else d=1024,t=768,n=(window.screenX||window.screenLeft)+((window.outerWidth||document.documentElement.offsetWidth)-d)/2,i=(window.screenY||window.screenTop)+((window.outerHeight||document.documentElement.offsetHeight)-t)/2,e.from_chat&&e.from_chat===!0?(a=e.tab&&e.tab===!0?window.open(e.joinURL?Moxtra._JOINUrl(e):Moxtra._SSOUrl(e,1),"moxtrabychat","width="+d+",height="+t+",left="+n+",top="+i+",resizable=yes,location=no","_blank"):window.open(e.joinURL?Moxtra._JOINUrl(e):Moxtra._SSOUrl(e,1),"moxtrabychat","width="+d+",height="+t+",left="+n+",top="+i+",resizable=yes,location=no"),Moxtra._popupbychat=a):(a=e.tab&&e.tab===!0?window.open(e.joinURL?Moxtra._JOINUrl(e):Moxtra._SSOUrl(e,1),"moxtra","width="+d+",height="+t+",left="+n+",top="+i+",resizable=yes,location=no","_blank"):window.open(e.joinURL?Moxtra._JOINUrl(e):Moxtra._SSOUrl(e,1),"moxtra","width="+d+",height="+t+",left="+n+",top="+i+",resizable=yes,location=no"),Moxtra._popup=a),a&&a.focus()})()},Moxtra.clip=function(e){Moxtra.note(e)},Moxtra.note=function(e){var t,o,n,r,a,i,d,s;if(!e)throw"You must pass in options";var c=Moxtra_Session.get("note_refresh");if(c){if(!e.noterefresh_binder_id)return}else if(Moxtra._noteiframe)return;(en=function(){if("Microsoft Internet Explorer"==navigator.appName){var m=document.getElementById("moxtraNoteBtn"),l=document.getElementById("moxtraButton"),_=function(){data=document.getElementById("moxtraCommData").value;var t=!1;t=e&&e.from_chat&&e.from_chat===!0?Moxtra._handleMessageFromChatEvent(JSON.parse(data),e):Moxtra._handleMessageEvent(JSON.parse(data),e),t&&(Moxtra.removeListener(m,"click",_),Moxtra.removeListener(l,"click",_))};Moxtra.addListener(m,"click",_),Moxtra.addListener(l,"click",_)}else{var p=function(t){if(t.origin==Moxtra.baseUrl){var o=!1;o=e&&e.from_chat&&e.from_chat===!0?Moxtra._handleMessageFromChatEvent(JSON.parse(t.data),e):Moxtra._handleMessageEvent(JSON.parse(t.data),e),o&&Moxtra.removeListener(window,"message",p)}};Moxtra.addListener(window,"message",p)}if(e.iframe&&e.iframe===!0){s=Moxtra._createWidgetElement(Moxtra._SSOUrl(e,2),e,!1,!1);var u;if(e.tagid4iframe)if(u=document.getElementById(e.tagid4iframe))e.border===!1?(u.appendChild(s),Moxtra._noteiframe=s):(o=Moxtra._createSimpleDivElement(e,s,"1024px","768px"),u.appendChild(o),Moxtra._noteiframe=o);else if(c)return Moxtra_Session.remove("note_refresh"),void s.remove();u||(r=Moxtra._createDivElement(e,s,"1024px","768px"),document.body.appendChild(r),Moxtra._noteiframe=r,r.scrollIntoView(!0))}else d=1024,t=768,n=(window.screenX||window.screenLeft)+((window.outerWidth||document.documentElement.offsetWidth)-d)/2,i=(window.screenY||window.screenTop)+((window.outerHeight||document.documentElement.offsetHeight)-t)/2,e.from_chat&&e.from_chat===!0?(a=window.open(Moxtra._SSOUrl(e,2),"moxtranotebychat","width="+d+",height="+t+",left="+n+",top="+i+",resizable=yes,location=no"),Moxtra._notepopupbychat=a):(a=window.open(Moxtra._SSOUrl(e,2),"moxtranote","width="+d+",height="+t+",left="+n+",top="+i+",resizable=yes,location=no"),Moxtra._notepopup=a),a&&a.focus()})()},Moxtra.chat=function(e){var t,o,n,r,a,i,d,s;if(!e)throw"You must pass in options";var c;if(e.iframe&&e.iframe===!0){if(e.tagid4iframe&&(c=document.getElementById(e.tagid4iframe),c&&Moxtra._hasChild(c))){var m=Moxtra._viewMap[e.tagid4iframe];m&&(c.removeChild(m),delete Moxtra._viewMap[e.tagid4iframe]);var l=Moxtra._handlerMap[e.tagid4iframe];l&&(Moxtra.removeListener(window,"message",l),delete Moxtra._handlerMap[e.tagid4iframe])}c||(Moxtra._chatiframe&&(document.body.removeChild(Moxtra._chatiframe),delete Moxtra._chatiframe),Moxtra._chatfunc&&(Moxtra.removeListener(window,"message",Moxtra._chatfunc),delete Moxtra._chatfunc))}(ec=function(){if("Microsoft Internet Explorer"==navigator.appName){var m=document.getElementById("moxtraButton"),l=function(){data=document.getElementById("moxtraCommData").value;var t=Moxtra._handleChatMessageEvent(JSON.parse(data),e,!0);t&&Moxtra.removeListener(m,"click",l)};Moxtra.addListener(m,"click",l)}else{var _=function(t){if(t.origin==Moxtra.baseUrl){var o=Moxtra._handleChatMessageEvent(JSON.parse(t.data),e,!0);o&&Moxtra.removeListener(window,"message",_)}};Moxtra.addListener(window,"message",_),e.iframe&&e.iframe===!0&&(c?Moxtra._handlerMap[e.tagid4iframe]=_:Moxtra._chatfunc=_)}e.iframe&&e.iframe===!0?(s=Moxtra._createWidgetElement(Moxtra._SSOUrl(e,3),e,!0,!1),e.tagid4iframe&&c&&(e.border===!1?(c.appendChild(s),Moxtra._viewMap[e.tagid4iframe]=s,e.handle_iframe=s):(o=Moxtra._createSimpleDivElement(e,s,"850px","500px"),c.appendChild(o),Moxtra._viewMap[e.tagid4iframe]=o,e.handle_iframe=o)),c||(r=Moxtra._createDivElement(e,s,"850px","500px"),document.body.appendChild(r),Moxtra._chatiframe=r,e.handle_iframe=r,r.scrollIntoView(!0))):(d=850,t=500,n=(window.screenX||window.screenLeft)+((window.outerWidth||document.documentElement.offsetWidth)-d)/2,i=(window.screenY||window.screenTop)+((window.outerHeight||document.documentElement.offsetHeight)-t)/2,a=window.open(Moxtra._SSOUrl(e,3),"moxtrachat","width="+d+",height="+t+",left="+n+",top="+i+",resizable=yes,location=no,scrollbars=1"),e.handle_popup=a,a&&a.focus())})()},Moxtra.timeline=function(e){var t,o,n,r,a,i,d,s;if(!e)throw"You must pass in options";var c;if(e.iframe&&e.iframe===!0){if(e.tagid4iframe&&(c=document.getElementById(e.tagid4iframe),c&&Moxtra._hasChild(c))){var m=Moxtra._viewMap[e.tagid4iframe];m&&(c.removeChild(m),delete Moxtra._viewMap[e.tagid4iframe]);var l=Moxtra._handlerMap[e.tagid4iframe];l&&(Moxtra.removeListener(window,"message",l),delete Moxtra._handlerMap[e.tagid4iframe])}c||(Moxtra._timelineiframe&&(document.body.removeChild(Moxtra._timelineiframe),delete Moxtra._timelineiframe),Moxtra._timelinefunc&&(Moxtra.removeListener(window,"message",Moxtra._timelinefunc),delete Moxtra._timelinefunc))}(ec=function(){if("Microsoft Internet Explorer"==navigator.appName){var m=document.getElementById("moxtraButton"),l=function(){data=document.getElementById("moxtraCommData").value;var t=Moxtra._handleChatMessageEvent(JSON.parse(data),e,!1);t&&Moxtra.removeListener(m,"click",l)};Moxtra.addListener(m,"click",l)}else{var _=function(t){if(t.origin==Moxtra.baseUrl){var o=Moxtra._handleChatMessageEvent(JSON.parse(t.data),e,!1);o&&Moxtra.removeListener(window,"message",_)}};Moxtra.addListener(window,"message",_),e.iframe&&e.iframe===!0&&(c?Moxtra._handlerMap[e.tagid4iframe]=_:Moxtra._timelinefunc=_)}e.iframe&&e.iframe===!0?(s=Moxtra._createWidgetElement(Moxtra._SSOUrl(e,5),e,!1,!1),e.tagid4iframe&&c&&(e.border===!1?(c.appendChild(s),Moxtra._viewMap[e.tagid4iframe]=s,e.handle_iframe=s):(o=Moxtra._createSimpleDivElement(e,s,"1024px","768px"),c.appendChild(o),Moxtra._viewMap[e.tagid4iframe]=o,e.handle_iframe=o)),c||(r=Moxtra._createDivElement(e,s,"1024px","768px"),document.body.appendChild(r),Moxtra._timelineiframe=r,e.handle_iframe=r,r.scrollIntoView(!0))):(d=1024,t=768,n=(window.screenX||window.screenLeft)+((window.outerWidth||document.documentElement.offsetWidth)-d)/2,i=(window.screenY||window.screenTop)+((window.outerHeight||document.documentElement.offsetHeight)-t)/2,a=window.open(Moxtra._SSOUrl(e,5),"moxtratimeline","width="+d+",height="+t+",left="+n+",top="+i+",resizable=yes,location=no,scrollbars=1"),e.handle_popup=a,a&&a.focus())})()},Moxtra._hasChild=function(e){for(var t=0;e&&e.childNodes[t];t++)if(1===e.childNodes[t].nodeType||11===e.childNodes[t].nodeType)return!0;return!1},Moxtra.timelineView=function(e){var t,o,n,r,a,i,d,s;if(!e)throw"You must pass in options";var c;if(e.iframe&&e.iframe===!0){if(e.tagid4iframe&&(c=document.getElementById(e.tagid4iframe),c&&Moxtra._hasChild(c))){var m=Moxtra._viewMap[e.tagid4iframe];m&&(c.removeChild(m),delete Moxtra._viewMap[e.tagid4iframe]);var l=Moxtra._handlerMap[e.tagid4iframe];l&&(Moxtra.removeListener(window,"message",l),delete Moxtra._handlerMap[e.tagid4iframe])}c||(Moxtra._timelineViewiframe&&(document.body.removeChild(Moxtra._timelineViewiframe),delete Moxtra._timelineViewiframe),Moxtra._timelineViewfunc&&(Moxtra.removeListener(window,"message",Moxtra._timelineViewfunc),delete Moxtra._timelineViewfunc))}(ec=function(){if("Microsoft Internet Explorer"==navigator.appName){var m=document.getElementById("moxtraButton"),l=function(){data=document.getElementById("moxtraCommData").value;var t=Moxtra._handleViewMessageEvent(JSON.parse(data),e,"timeline");t&&Moxtra.removeListener(m,"click",l)};Moxtra.addListener(m,"click",l)}else{var _=function(t){if(t.origin==Moxtra.baseUrl){var o=Moxtra._handleViewMessageEvent(JSON.parse(t.data),e,"timeline");o&&Moxtra.removeListener(window,"message",_)}};Moxtra.addListener(window,"message",_),e.iframe&&e.iframe===!0&&(c?Moxtra._handlerMap[e.tagid4iframe]=_:Moxtra._timelineViewfunc=_)}e.iframe&&e.iframe===!0?(s=Moxtra._createWidgetElement(Moxtra._SSOUrl(e,9),e,!1,!0),e.tagid4iframe&&c&&(e.border===!1?(c.appendChild(s),Moxtra._viewMap[e.tagid4iframe]=s,e.handle_iframe=s):(o=Moxtra._createSimpleDivElement(e,s,"330px","768px"),c.appendChild(o),Moxtra._viewMap[e.tagid4iframe]=o,e.handle_iframe=o)),c||(r=Moxtra._createDivElement(e,s,"330px","768px"),document.body.appendChild(r),Moxtra._timelineViewiframe=r,e.handle_iframe=r,r.scrollIntoView(!0))):(d=330,t=768,n=(window.screenX||window.screenLeft)+((window.outerWidth||document.documentElement.offsetWidth)-d)/2,i=(window.screenY||window.screenTop)+((window.outerHeight||document.documentElement.offsetHeight)-t)/2,a=window.open(Moxtra._SSOUrl(e,9),"moxtratimelineView","width="+d+",height="+t+",left="+n+",top="+i+",resizable=yes,location=no,scrollbars=1"),e.handle_popup=a,a&&a.focus())})()},Moxtra.chatView=function(e){var t,o,n,r,a,i,d,s;if(!e)throw"You must pass in options";if(!e.binder_id)throw"You must set binder_id";var c;if(e.iframe&&e.iframe===!0){if(e.tagid4iframe&&(c=document.getElementById(e.tagid4iframe),c&&Moxtra._hasChild(c))){var m=Moxtra._viewMap[e.tagid4iframe];m&&(c.removeChild(m),delete Moxtra._viewMap[e.tagid4iframe]);var l=Moxtra._handlerMap[e.tagid4iframe];l&&(Moxtra.removeListener(window,"message",l),delete Moxtra._handlerMap[e.tagid4iframe])}c||(Moxtra._chatViewiframe&&(document.body.removeChild(Moxtra._chatViewiframe),delete Moxtra._chatViewiframe),Moxtra._chatViewfunc&&(Moxtra.removeListener(window,"message",Moxtra._chatViewfunc),delete Moxtra._chatViewfunc))}(ec=function(){if("Microsoft Internet Explorer"==navigator.appName){var m=document.getElementById("moxtraButton"),l=function(){data=document.getElementById("moxtraCommData").value;var t=Moxtra._handleViewMessageEvent(JSON.parse(data),e,"chat");t&&Moxtra.removeListener(m,"click",l)};Moxtra.addListener(m,"click",l)}else{var _=function(t){if(t.origin==Moxtra.baseUrl){var o=Moxtra._handleViewMessageEvent(JSON.parse(t.data),e,"chat");o&&Moxtra.removeListener(window,"message",_)}};Moxtra.addListener(window,"message",_),e.iframe&&e.iframe===!0&&(c?Moxtra._handlerMap[e.tagid4iframe]=_:Moxtra._chatViewfunc=_)}e.iframe&&e.iframe===!0?(s=Moxtra._createWidgetElement(Moxtra._SSOUrl(e,10),e,!0,!0),e.tagid4iframe&&c&&(e.border===!1?(c.appendChild(s),Moxtra._viewMap[e.tagid4iframe]=s,e.handle_iframe=s):(o=Moxtra._createSimpleDivElement(e,s,"850px","500px"),c.appendChild(o),Moxtra._viewMap[e.tagid4iframe]=o,e.handle_iframe=o)),c||(r=Moxtra._createDivElement(e,s,"850px","500px"),document.body.appendChild(r),Moxtra._chatViewiframe=r,e.handle_iframe=r,r.scrollIntoView(!0))):(d=850,t=500,n=(window.screenX||window.screenLeft)+((window.outerWidth||document.documentElement.offsetWidth)-d)/2,i=(window.screenY||window.screenTop)+((window.outerHeight||document.documentElement.offsetHeight)-t)/2,a=window.open(Moxtra._SSOUrl(e,10),"moxtrachatView","width="+d+",height="+t+",left="+n+",top="+i+",resizable=yes,location=no,scrollbars=1"),e.handle_popup=a,a&&a.focus())})()},Moxtra.pageView=function(e){var t,o,n,r,a,i,d,s;if(!e)throw"You must pass in options";if(!e.binder_id&&!e.viewlink_url)throw"You must set binder_id or viewlink_url";var c;if(e.iframe&&e.iframe===!0){if(e.tagid4iframe&&(c=document.getElementById(e.tagid4iframe),c&&Moxtra._hasChild(c))){var m=Moxtra._viewMap[e.tagid4iframe];m&&(c.removeChild(m),delete Moxtra._viewMap[e.tagid4iframe]);var l=Moxtra._handlerMap[e.tagid4iframe];l&&(Moxtra.removeListener(window,"message",l),delete Moxtra._handlerMap[e.tagid4iframe])}c||(Moxtra._pageViewiframe&&(document.body.removeChild(Moxtra._pageViewiframe),delete Moxtra._pageViewiframe),Moxtra._pageViewfunc&&(Moxtra.removeListener(window,"message",Moxtra._pageViewfunc),delete Moxtra._pageViewfunc))}(ec=function(){if("Microsoft Internet Explorer"==navigator.appName){var m=document.getElementById("moxtraButton"),l=function(){data=document.getElementById("moxtraCommData").value;var t=Moxtra._handleViewMessageEvent(JSON.parse(data),e,"page");t&&Moxtra.removeListener(m,"click",l)};Moxtra.addListener(m,"click",l)}else{var _=function(t){if(t.origin==Moxtra.baseUrl){var o=Moxtra._handleViewMessageEvent(JSON.parse(t.data),e,"page");o&&Moxtra.removeListener(window,"message",_)}};Moxtra.addListener(window,"message",_),e.iframe&&e.iframe===!0&&(c?Moxtra._handlerMap[e.tagid4iframe]=_:Moxtra._pageViewfunc=_)}e.iframe&&e.iframe===!0?(s=Moxtra._createWidgetElement(Moxtra._SSOUrl(e,11),e,!0,!0),e.tagid4iframe&&c&&(e.border===!1?(c.appendChild(s),Moxtra._viewMap[e.tagid4iframe]=s,e.handle_iframe=s):(o=Moxtra._createSimpleDivElement(e,s,"850px","500px"),c.appendChild(o),Moxtra._viewMap[e.tagid4iframe]=o,e.handle_iframe=o)),c||(r=Moxtra._createDivElement(e,s,"850px","500px"),document.body.appendChild(r),Moxtra._pageViewiframe=r,e.handle_iframe=r,r.scrollIntoView(!0))):(d=850,t=500,n=(window.screenX||window.screenLeft)+((window.outerWidth||document.documentElement.offsetWidth)-d)/2,i=(window.screenY||window.screenTop)+((window.outerHeight||document.documentElement.offsetHeight)-t)/2,a=window.open(Moxtra._SSOUrl(e,11),"moxtrapageView","width="+d+",height="+t+",left="+n+",top="+i+",resizable=yes,location=no,scrollbars=1"),e.handle_popup=a,a&&a.focus())})()},Moxtra.todoView=function(e){var t,o,n,r,a,i,d,s;if(!e)throw"You must pass in options";if(!e.binder_id)throw"You must set binder_id";var c;if(e.iframe&&e.iframe===!0){if(e.tagid4iframe&&(c=document.getElementById(e.tagid4iframe),c&&Moxtra._hasChild(c))){var m=Moxtra._viewMap[e.tagid4iframe];m&&(c.removeChild(m),delete Moxtra._viewMap[e.tagid4iframe]);var l=Moxtra._handlerMap[e.tagid4iframe];l&&(Moxtra.removeListener(window,"message",l),delete Moxtra._handlerMap[e.tagid4iframe])}c||(Moxtra._todoViewiframe&&(document.body.removeChild(Moxtra._todoViewiframe),delete Moxtra._todoViewiframe),Moxtra._todoViewfunc&&(Moxtra.removeListener(window,"message",Moxtra._todoViewfunc),delete Moxtra._todoViewfunc))}(ec=function(){if("Microsoft Internet Explorer"==navigator.appName){var m=document.getElementById("moxtraButton"),l=function(){data=document.getElementById("moxtraCommData").value;var t=Moxtra._handleViewMessageEvent(JSON.parse(data),e,"todo");t&&Moxtra.removeListener(m,"click",l)};Moxtra.addListener(m,"click",l)}else{var _=function(t){if(t.origin==Moxtra.baseUrl){var o=Moxtra._handleViewMessageEvent(JSON.parse(t.data),e,"todo");o&&Moxtra.removeListener(window,"message",_)}};Moxtra.addListener(window,"message",_),e.iframe&&e.iframe===!0&&(c?Moxtra._handlerMap[e.tagid4iframe]=_:Moxtra._todoViewfunc=_)}e.iframe&&e.iframe===!0?(s=Moxtra._createWidgetElement(Moxtra._SSOUrl(e,12),e,!0,!0),e.tagid4iframe&&c&&(e.border===!1?(c.appendChild(s),Moxtra._viewMap[e.tagid4iframe]=s,e.handle_iframe=s):(o=Moxtra._createSimpleDivElement(e,s,"850px","500px"),c.appendChild(o),Moxtra._viewMap[e.tagid4iframe]=o,e.handle_iframe=o)),c||(r=Moxtra._createDivElement(e,s,"850px","500px"),document.body.appendChild(r),Moxtra._todoViewiframe=r,e.handle_iframe=r,r.scrollIntoView(!0))):(d=850,t=500,n=(window.screenX||window.screenLeft)+((window.outerWidth||document.documentElement.offsetWidth)-d)/2,i=(window.screenY||window.screenTop)+((window.outerHeight||document.documentElement.offsetHeight)-t)/2,a=window.open(Moxtra._SSOUrl(e,12),"moxtratodoView","width="+d+",height="+t+",left="+n+",top="+i+",resizable=yes,location=no,scrollbars=1"),e.handle_popup=a,a&&a.focus())})()},Moxtra.annotate=function(e){var t,o,n,r,a,i,d,s;if(!e)throw"You must pass in options";if(Moxtra._annotateiframe){var c;e.iframe===!0&&e.tagid4iframe&&(c=document.getElementById(e.tagid4iframe),c&&c.removeChild(Moxtra._annotateiframe)),c||document.body.removeChild(Moxtra._annotateiframe),Moxtra._annotateiframe=null,Moxtra._annotefunc&&(Moxtra.removeListener(window,"message",Moxtra._annotefunc),Moxtra._annotefunc=null)}(an=function(){if("Microsoft Internet Explorer"==navigator.appName){var c=document.getElementById("moxtraButton"),m=function(){data=document.getElementById("moxtraCommData").value;var t=Moxtra._handleMessageEvent(JSON.parse(data),e,!0);t&&Moxtra.removeListener(c,"click",m)};Moxtra.addListener(c,"click",m)}else Moxtra._annotefunc=function(t){if(t.origin==Moxtra.baseUrl){var o=Moxtra._handleMessageEvent(JSON.parse(t.data),e,!0);o&&Moxtra.removeListener(window,"message",Moxtra._annotefunc)}},Moxtra.addListener(window,"message",Moxtra._annotefunc);if(e.iframe&&e.iframe===!0){var l;s=Moxtra._createWidgetElement(Moxtra._SSOUrl(e,6),e,!0,!1),e.tagid4iframe&&(l=document.getElementById(e.tagid4iframe),l&&(e.border===!1?(l.appendChild(s),Moxtra._annotateiframe=s):(o=Moxtra._createSimpleDivElement(e,s,"850px","500px"),l.appendChild(o),Moxtra._annotateiframe=o))),l||(r=Moxtra._createDivElement(e,s,"850px","500px"),document.body.appendChild(r),Moxtra._annotateiframe=r,r.scrollIntoView(!0))}else d=850,t=500,n=(window.screenX||window.screenLeft)+((window.outerWidth||document.documentElement.offsetWidth)-d)/2,i=(window.screenY||window.screenTop)+((window.outerHeight||document.documentElement.offsetHeight)-t)/2,a=window.open(Moxtra._SSOUrl(e,6),"moxtraannotate","width="+d+",height="+t+",left="+n+",top="+i+",resizable=yes,location=no,scrollbars=1"),Moxtra._annotatepopup=a,a&&a.focus()})()},Moxtra.video=function(e){var t,o,n,r,a,i,d,s;if(!e)throw"You must pass in options";var c=Moxtra_Session.get("video_refresh");if(c){if(!e.videorefresh_session_key)return}else if(Moxtra._videoiframe)return;(ef=function(){if("Microsoft Internet Explorer"==navigator.appName){var m=document.getElementById("moxtraButton"),l=function(){data=document.getElementById("moxtraCommData").value;var t=!1;t=e&&e.from_chat&&e.from_chat===!0?Moxtra._handleMessageFromChatEvent(JSON.parse(data),e):Moxtra._handleVideoMessageEvent(JSON.parse(data),e),t&&Moxtra.removeListener(m,"click",l)};Moxtra.addListener(m,"click",l)}else{var _=function(t){if(t.origin==Moxtra.baseUrl){var o=!1;o=e&&e.from_chat&&e.from_chat===!0?Moxtra._handleMessageFromChatEvent(JSON.parse(t.data),e):Moxtra._handleVideoMessageEvent(JSON.parse(t.data),e),o&&Moxtra.removeListener(window,"message",_)}};Moxtra.addListener(window,"message",_)}if(e.iframe&&e.iframe===!0){s=Moxtra._createWidgetElement(Moxtra._SSOUrl(e,8),e,!1,!1);var p;if(e.tagid4iframe)if(p=document.getElementById(e.tagid4iframe))e.border===!1?(p.appendChild(s),Moxtra._videoiframe=s):(o=Moxtra._createSimpleDivElement(e,s,"400px","300px"),p.appendChild(o),Moxtra._videoiframe=o);else if(c)return Moxtra_Session.remove("video_refresh"),void s.remove();p||(r=Moxtra._createDivElement(e,s,"400px","300px"),document.body.appendChild(r),Moxtra._videoiframe=r,r.scrollIntoView(!0))}else d=400,t=300,n=(window.screenX||window.screenLeft)+((window.outerWidth||document.documentElement.offsetWidth)-d)/2,i=(window.screenY||window.screenTop)+((window.outerHeight||document.documentElement.offsetHeight)-t)/2,e.from_chat&&e.from_chat===!0?(a=e.tab&&e.tab===!0?window.open(Moxtra._SSOUrl(e,8),"moxtravideobychat","width="+d+",height="+t+",left="+n+",top="+i+",resizable=yes,location=no","_blank"):window.open(Moxtra._SSOUrl(e,8),"moxtravideobychat","width="+d+",height="+t+",left="+n+",top="+i+",resizable=yes,location=no"),Moxtra._videopopupbychat=a):(a=e.tab&&e.tab===!0?window.open(Moxtra._SSOUrl(e,8),"moxtravideo","width="+d+",height="+t+",left="+n+",top="+i+",resizable=yes,location=no","_blank"):window.open(Moxtra._SSOUrl(e,8),"moxtravideo","width="+d+",height="+t+",left="+n+",top="+i+",resizable=yes,location=no"),Moxtra._videopopup=a),a&&a.focus()})()},Moxtra._getMeetURL=function(e,t,o,n){var r;if(o)r=o;else if(t){if(!Moxtra.session_key)return void alert("Need to start a Moxtra Meet first!");r=Moxtra.session_key}else{if(!Moxtra.video_session_key)return void alert("Need to start a Moxtra Video first!");r=Moxtra.video_session_key}var a="websdk";n&&(a=n);var i,d=encodeURIComponent(window.location.protocol+"//"+window.location.host);return i=e?Moxtra.baseUrl+"/service/#api.endMeet/"+r+"?type="+a+"&client_id="+Moxtra.clientId+"&origin="+d:Moxtra.baseUrl+"/service/#api.leaveMeet/"+r+"?type="+a+"&client_id="+Moxtra.clientId+"&origin="+d,t||(i+="&video=true"),t&&Moxtra.access_token?i+="&access_token="+Moxtra.access_token:!t&&Moxtra.video_access_token?i+="&access_token="+Moxtra.video_access_token:Moxtra.appKey&&(i=Moxtra.ssoUrl+"?idpid="+Moxtra.appKey+"&target="+encodeURIComponent(i),Moxtra.partnerId?i+="&partnerid="+Moxtra.partnerId:Moxtra.orgId&&(i+="&orgid="+Moxtra.orgId)),i},Moxtra.getJoinMeetURL=function(e,t,o,n,r,a,i){var d;if(e)d=e;else{if(!Moxtra.session_key)return void alert("Need to start a Moxtra Meet first!");d=Moxtra.session_key}var s="websdk";o&&(s=o);var c=encodeURIComponent(window.location.protocol+"//"+window.location.host),m=Moxtra.baseUrl+"/service/#join?session_key="+d+"&type="+s+"&client_id="+Moxtra.clientId+"&origin="+c;return t&&(m+="&name=",m+=encodeURIComponent(t)),r&&(m+="&extension="+encodeURIComponent(JSON.stringify(r))),a&&(m+="&invisible="+a),i&&(m+="&video=true"),n?m+="&access_token="+n:Moxtra.accessToken?m+="&access_token="+Moxtra.accessToken:Moxtra.appKey&&(m=Moxtra.ssoUrl+"?idpid="+Moxtra.appKey+"&target="+encodeURIComponent(m),Moxtra.partnerId?m+="&partnerid="+Moxtra.partnerId:Moxtra.orgId&&(m+="&orgid="+Moxtra.orgId)),m},Moxtra.binderChooser=function(e){(bc=function(){if("Microsoft Internet Explorer"==navigator.appName){var t=document.getElementById("moxtraButton"),o=function(){data=document.getElementById("moxtraCommData").value,Moxtra._selected(JSON.parse(data),e),Moxtra.removeListener(t,"click",o)};Moxtra.addListener(t,"click",o)}else{var n=function(t){if(t.source==Moxtra._window){var o=JSON.parse(t.data);Moxtra._selected(o,e),Moxtra.removeListener(window,"message",n)}};Moxtra.addListener(window,"message",n)}var r,a,i,d="websdk";if(e&&e.type&&(d=e.type),Moxtra.appKey)r=Moxtra.ssoUrl+"?idpid="+Moxtra.appKey+"&target="+encodeURIComponent(Moxtra.baseUrl+"/service/#chooser?client_id="+Moxtra.clientId+"&type="+d),Moxtra.partnerId?r+="&partnerid="+Moxtra.partnerId:Moxtra.orgId&&(r+="&orgid="+Moxtra.orgId);else if(e&&e.token){var s=encodeURIComponent(window.location.protocol+"//"+window.location.host);r=Moxtra.baseUrl+"/login?token="+encodeURIComponent(e.token)+"&loginUrl="+encodeURIComponent(e.loginUrl)+"&type="+d+"&client_id="+Moxtra.clientId+"&origin="+s+"&backUrl="+encodeURIComponent(Moxtra.baseUrl+"/service/#chooser?client_id="+Moxtra.clientId+"&type="+d)}else r=Moxtra.baseUrl+"/service/#chooser?client_id="+Moxtra.clientId+"&type="+d;a=e&&e.width?e.width:"886",i=e&&e.height?e.height:"560",Moxtra._window=window.open(r,"chooser","location=0,scrollbars=1,status=0,titlebar=0,toolbar=0,menubar=0,width="+a+",height="+i),Moxtra._window.focus()})()},Moxtra.pageChooser=function(e){(pc=function(){if("Microsoft Internet Explorer"==navigator.appName){var t=document.getElementById("moxtraButton"),o=function(){data=document.getElementById("moxtraCommData").value,Moxtra._pageSelected(JSON.parse(data),e),Moxtra.removeListener(t,"click",o)};Moxtra.addListener(t,"click",o)}else{var n=function(t){if(t.source==Moxtra._pageWindow){var o=JSON.parse(t.data);Moxtra._pageSelected(o,e),Moxtra.removeListener(window,"message",n)}};Moxtra.addListener(window,"message",n)}var r,a="websdk";if(e&&e.type&&(a=e.type),Moxtra.appKey)r=Moxtra.ssoUrl+"?idpid="+Moxtra.appKey+"&target="+encodeURIComponent(Moxtra.baseUrl+"/api/html/pageselector.htm?client_id="+Moxtra.clientId),Moxtra.partnerId?r+="&partnerid="+Moxtra.partnerId:Moxtra.orgId&&(r+="&orgid="+Moxtra.orgId);else if(e&&e.token){var i=encodeURIComponent(window.location.protocol+"//"+window.location.host);r=Moxtra.baseUrl+"/login?token="+encodeURIComponent(e.token)+"&loginUrl="+encodeURIComponent(e.loginUrl)+"&type="+a+"&client_id="+Moxtra.clientId+"&origin="+i+"&backUrl="+encodeURIComponent(Moxtra.baseUrl+"/api/html/pageselector.htm?client_id="+Moxtra.clientId)}else r=Moxtra.baseUrl+"/api/html/pageselector.htm?client_id="+Moxtra.clientId;Moxtra._pageWindow=window.open(r,"pageChooser","location=0,scrollbars=1,status=0,titlebar=0,toolbar=0,menubar=0,width=886,height=560"),Moxtra._pageWindow.focus()})()},Moxtra.toolbar_startmeet=function(){return Moxtra.meet({success:function(e){var t;document.createEvent&&(t=document.createEvent("Event"),t.initEvent("MeetSuccess",!1,!1),t.session_key=e.session_key,t.meet_id=e.meet_id,t.session_id=e.session_id,Moxtra._toolbar.dispatchEvent(t))},error:function(e){var t;document.createEvent&&(t=document.createEvent("Event"),t.initEvent("MeetError",!1,!1),t.error_code=e.error_code,t.error_message=e.error_message,Moxtra._toolbar.dispatchEvent(t))},exit:function(){var e;document.createEvent&&(e=document.createEvent("Event"),e.initEvent("MeetExit",!1,!1),Moxtra._toolbar.dispatchEvent(e))},invite:function(e){var t;document.createEvent&&(t=document.createEvent("Event"),t.initEvent("MeetInvite",!1,!1),t.binder_id=e.binder_id,t.session_key=e.session_key,t.meet_id=e.meet_id,t.session_id=e.session_id,Moxtra._toolbar.dispatchEvent(t))},invited:function(e){var t;document.createEvent&&(t=document.createEvent("Event"),t.initEvent("MemberInvited",!1,!1),t.binder_id=e.binder_id,t.session_key=e.session_key,t.meet_id=e.meet_id,t.session_id=e.session_id,Moxtra._toolbar.dispatchEvent(t))},save:function(e){var t;document.createEvent&&(t=document.createEvent("Event"),t.initEvent("MeetSaved",!1,!1),t.binder_id=e.binder_id,t.session_key=e.session_key,t.meet_id=e.meet_id,t.session_id=e.session_id,Moxtra._toolbar.dispatchEvent(t))},iframe:!1,_trigger:"button"}),!1},Moxtra.toolbar_startnote=function(){return Moxtra.note({start_note:function(e){var t;document.createEvent&&(t=document.createEvent("Event"),t.initEvent("NoteStart",!1,!1),t.session_key=e.session_key,t.meet_id=e.meet_id,t.session_id=e.session_id,Moxtra._toolbar.dispatchEvent(t))},error:function(e){var t;document.createEvent&&(t=document.createEvent("Event"),t.initEvent("NoteError",!1,!1),t.error_code=e.error_code,t.error_message=e.error_message,Moxtra._toolbar.dispatchEvent(t))},save_note:function(e){var t;document.createEvent&&(t=document.createEvent("Event"),t.initEvent("NoteSave",!1,!1),t.destination_binder_id=e.destination_binder_id,t.download_url=e.download_url,t.share_url=e.share_url,Moxtra._toolbar.dispatchEvent(t))},cancel:function(){var e;document.createEvent&&(e=document.createEvent("Event"),e.initEvent("NoteCancel",!1,!1),Moxtra._toolbar.dispatchEvent(e))},iframe:!1,_trigger:"button"}),!1},Moxtra.toolbar_startchat=function(){return Moxtra.chat({start_chat:function(e){var t;document.createEvent&&(t=document.createEvent("Event"),t.initEvent("ChatStart",!1,!1),t.binder_id=e.binder_id,t.session_id=e.session_id,Moxtra._toolbar.dispatchEvent(t))
},request_meet:function(e){var t;document.createEvent&&(t=document.createEvent("Event"),t.initEvent("MeetRequest",!1,!1),t.binder_id=e.binder_id,Moxtra._toolbar.dispatchEvent(t))},request_note:function(){var e;document.createEvent&&(e=document.createEvent("Event"),e.initEvent("NoteRequest",!1,!1),Moxtra._toolbar.dispatchEvent(e))},error:function(e){var t;document.createEvent&&(t=document.createEvent("Event"),t.initEvent("ChatError",!1,!1),t.error_code=e.error_code,t.error_message=e.error_message,Moxtra._toolbar.dispatchEvent(t))},iframe:!1,_trigger:"button"}),!1},Moxtra._selected=function(e,t){t&&"function"==typeof t.select?t.select(e):Moxtra._chooser&&document.createEvent&&(m=document.createEvent("Event"),m.initEvent("BinderSelect",!1,!1),m.binder_name=e.binder_name,m.binder_id=e.binder_id,m.binder_imageUrl=e.binder_imageUrl,m.binder_viewUrl=e.binder_viewUrl,Moxtra._chooser.dispatchEvent(m)),Moxtra._window.close()},Moxtra._pageSelected=function(e,t){t&&"function"==typeof t.select?t.select(e):Moxtra._pageChooser&&document.createEvent&&(m=document.createEvent("Event"),m.initEvent("PagesSelect",!1,!1),m.binder_name=e.binder_name,m.binder_id=e.binder_id,m.binder_imageUrl=e.binder_imageUrl,m.binder_viewUrl=e.binder_viewUrl,m.page_url_prefix=e.page_url_prefix,m.page_viewUrl_prefix=e.page_viewUrl_prefix,m.pages=e.pages,Moxtra._pageChooser.dispatchEvent(m)),Moxtra._pageWindow.close()},Moxtra.setValue=function(e,t){if(null!=e&&void 0!==e&&1==e.nodeType){var o=e.tagName.toLowerCase();"div"==o?e.innerHTML=t:"input"==o?e.value=t:"img"==o&&(img.src=t)}},function(){var e,t,o,n,r,a,i,d,s,c;n=document.getElementById("moxtrajs"),Moxtra.appKey||(Moxtra.appKey=null!=n?n.getAttribute("data-app-key"):void 0),Moxtra.partnerId||(Moxtra.partnerId=null!=n?n.getAttribute("data-partner-id"):void 0),Moxtra.orgId||(Moxtra.orgId=null!=n?n.getAttribute("data-org-id"):void 0),Moxtra.clientId||(Moxtra.clientId=null!=n?n.getAttribute("data-client-id"):void 0);var m=n.getAttribute("src");m.indexOf("grouphour.com")<0?m.indexOf("../js")<0||(Moxtra.baseUrl="https://"+window.location.host):Moxtra.baseUrl="https://www.grouphour.com",Moxtra.ssoUrl="idpdemo"==Moxtra.appKey?Moxtra.baseUrl+"/sp/spdemo":Moxtra.baseUrl+"/sp/startSSO",t=document.createElement("style"),t.type="text/css",o=".moxtra-meet { width: 73px; height: 35px; border: solid 1px navy; box-shadow: 2px 2px 3px #535353; border-radius: 5px; cursor: pointer;\n background-image: url('https://www.moxtra.com/api/images/logo-meet2.png'); }\n.moxtra-meet:hover { border: solid navy 2px; background-position: 2px 2px; }\n.moxtra-meet:active { background-position: 0 2px; }\n.moxtra-meet-selected { }\n.moxtra-meet-selected:hover { }\n.moxtra-meet-selected:active { }",t.styleSheet?t.styleSheet.cssText=o:t.textContent=o,document.getElementsByTagName("head")[0].appendChild(t),b2=document.createElement("style"),b2.type="text/css",c2=".moxtra-note { width: 76px; height: 35px; border: solid 1px navy; box-shadow: 2px 2px 3px #535353; border-radius: 5px; cursor: pointer;\n background-image: url('https://www.moxtra.com/api/images/logo-note.png'); }\n.moxtra-note:hover { border: solid navy 2px; background-position: 2px 2px; }\n.moxtra-note:active { background-position: 0 2px; }\n.moxtra-note-selected { }\n.moxtra-note-selected:hover { }\n.moxtra-note-selected:active { }",b2.styleSheet?b2.styleSheet.cssText=c2:b2.textContent=c2,document.getElementsByTagName("head")[0].appendChild(b2),b3=document.createElement("style"),b3.type="text/css",c3=".moxtra-chat { width: 61px; height: 35px; border: solid 1px navy; box-shadow: 2px 2px 3px #535353; border-radius: 5px; cursor: pointer;\n background-image: url('https://www.moxtra.com/api/images/logo-chat.png'); }\n.moxtra-chat:hover { border: solid navy 2px; background-position: 2px 2px; }\n.moxtra-chat:active { background-position: 0 2px; }\n.moxtra-chat-selected { }\n.moxtra-chat-selected:hover { }\n.moxtra-chat-selected:active { }",b3.styleSheet?b3.styleSheet.cssText=c3:b3.textContent=c3,document.getElementsByTagName("head")[0].appendChild(b3);var l=document.createElement("style");l.type="text/css";var _=".moxtra-chooser { width: 100px; height: 35px; border: solid 1px navy; box-shadow: 2px 2px 3px #535353; border-radius: 5px; cursor: pointer;\n  background-image: url('https://www.moxtra.com/api/images/logo-binder2.png'); }\n.moxtra-chooser:hover { border: solid navy 2px; background-position: 2px 2px; }\n.moxtra-chooser:active { background-position: 0 2px; }\n.moxtra-chooser-selected { }\n.moxtra-chooser-selected:hover { }\n.moxtra-chooser-selected:active { }";l.styleSheet?l.styleSheet.cssText=_:l.textContent=_,document.getElementsByTagName("head")[0].appendChild(l);var p=document.createElement("style");p.type="text/css";var u=".moxtra-pagechooser { width: 69px; height: 35px; border: solid 1px navy; box-shadow: 2px 2px 3px #535353; border-radius: 5px; cursor: pointer;\n  background-image: url('https://www.moxtra.com/api/images/logo-page.png'); }\n.moxtra-pagechooser:hover { border: solid navy 2px; background-position: 2px 2px; }\n.moxtra-pagechooser:active { background-position: 0 2px; }\n.moxtra-pagechooser-selected { }\n.moxtra-pagechooser-selected:hover { }\n.moxtra-pagechooser-selected:active { }";p.styleSheet?p.styleSheet.cssText=u:p.textContent=u,document.getElementsByTagName("head")[0].appendChild(p),e=function(){var t,o,n,m,l;if(document.removeEventListener?document.removeEventListener("DOMContentLoaded",e,!1):document.detachEvent&&document.detachEvent("onreadystatechange",e),"Microsoft Internet Explorer"==navigator.appName){var _=document.createElement("form");_.setAttribute("name","moxtraWin");var p=document.createElement("input");p.setAttribute("type","hidden"),p.setAttribute("id","moxtraCommData"),p.setAttribute("name","moxtraCommData");var u=document.createElement("input");u.setAttribute("type","button"),u.setAttribute("name","moxtraButton"),u.setAttribute("id","moxtraButton"),u.setAttribute("value",""),u.style.display="none";var x=document.createElement("input");x.setAttribute("type","button"),x.setAttribute("name","moxtraNoteBtn"),x.setAttribute("id","moxtraNoteBtn"),x.setAttribute("value",""),x.style.display="none",_.appendChild(p),_.appendChild(u),_.appendChild(x),document.getElementsByTagName("body")[0].appendChild(_)}var v=Moxtra_Session.get("meet_refresh"),f=Moxtra_Session.get("note_refresh"),M=Moxtra_Session.get("video_refresh");for(o=document.getElementsByTagName("input"),n=function(e){var t;if(("moxtra-meet"===e.getAttribute("type")||"moxtra-meet-iframe"===e.getAttribute("type"))&&(t=document.createElement("div"),t.className="moxtra-meet",e.style.display="none",Moxtra._meet=e,a="moxtra-meet-iframe"===e.getAttribute("type")?t:null,Moxtra.addListener(t,"click",function(){r="moxtra-meet-iframe"===e.getAttribute("type")?!0:!1,v=Moxtra_Session.get("meet_refresh"),Moxtra.meet(v||{success:function(o){var n;document.createEvent&&(n=document.createEvent("Event"),n.initEvent("MeetSuccess",!1,!1),n.session_key=o.session_key,n.meet_id=o.meet_id,n.session_id=o.session_id,e.dispatchEvent(n)),t.className="moxtra-meet moxtra-meet-used"},error:function(t){var o;document.createEvent&&(o=document.createEvent("Event"),o.initEvent("MeetError",!1,!1),o.error_code=t.error_code,o.error_message=t.error_message,e.dispatchEvent(o))},exit:function(){var t;document.createEvent&&(t=document.createEvent("Event"),t.initEvent("MeetExit",!1,!1),e.dispatchEvent(t))},invite:function(t){var o;document.createEvent&&(o=document.createEvent("Event"),o.initEvent("MeetInvite",!1,!1),o.binder_id=t.binder_id,o.session_key=t.session_key,o.meet_id=t.meet_id,o.session_id=t.session_id,e.dispatchEvent(o))},invited:function(t){var o;document.createEvent&&(o=document.createEvent("Event"),o.initEvent("MemberInvited",!1,!1),o.binder_id=t.binder_id,o.session_key=t.session_key,o.meet_id=t.meet_id,o.session_id=t.session_id,e.dispatchEvent(o))},save:function(t){var o;document.createEvent&&(o=document.createEvent("Event"),o.initEvent("MeetSaved",!1,!1),o.binder_id=t.binder_id,o.session_key=t.session_key,o.meet_id=t.meet_id,o.session_id=t.session_id,e.dispatchEvent(o))},iframe:r?!0:!1,extension:{show_dialogs:{meet_invite:!0}},_trigger:"button"})}),e.parentNode.insertBefore(t,e)),("moxtra-note"===e.getAttribute("type")||"moxtra-note-iframe"===e.getAttribute("type"))&&(nt=document.createElement("div"),nt.className="moxtra-note",e.style.display="none",Moxtra._note=e,d="moxtra-note-iframe"===e.getAttribute("type")?t:null,Moxtra.addListener(nt,"click",function(){i="moxtra-note-iframe"===e.getAttribute("type")?!0:!1,f=Moxtra_Session.get("note_refresh"),Moxtra.note(f||{start_note:function(t){var o;document.createEvent&&(o=document.createEvent("Event"),o.initEvent("NoteStart",!1,!1),o.session_key=t.session_key,o.meet_id=t.meet_id,o.session_id=t.session_id,e.dispatchEvent(o)),nt.className="moxtra-note moxtra-note-used"},error:function(t){var o;document.createEvent&&(o=document.createEvent("Event"),o.initEvent("NoteError",!1,!1),o.error_code=t.error_code,o.error_message=t.error_message,e.dispatchEvent(o))},save_note:function(t){var o;document.createEvent&&(o=document.createEvent("Event"),o.initEvent("NoteSave",!1,!1),o.destination_binder_id=t.destination_binder_id,o.download_url=t.download_url,o.share_url=t.share_url,e.dispatchEvent(o))},cancel:function(){var t;document.createEvent&&(t=document.createEvent("Event"),t.initEvent("NoteCancel",!1,!1),e.dispatchEvent(t))},iframe:i?!0:!1,_trigger:"button"})}),e.parentNode.insertBefore(nt,e)),("moxtra-chat"===e.getAttribute("type")||"moxtra-chat-iframe"===e.getAttribute("type"))&&(nt=document.createElement("div"),nt.className="moxtra-chat",e.style.display="none",Moxtra._chat=e,c="moxtra-chat-iframe"===e.getAttribute("type")?t:null,Moxtra.addListener(nt,"click",function(){s="moxtra-chat-iframe"===e.getAttribute("type")?!0:!1,Moxtra.chat({start_chat:function(t){var o;document.createEvent&&(o=document.createEvent("Event"),o.initEvent("ChatStart",!1,!1),o.binder_id=t.binder_id,o.session_id=t.session_id,e.dispatchEvent(o)),nt.className="moxtra-chat moxtra-chat-used"},request_meet:function(t){var o;document.createEvent&&(o=document.createEvent("Event"),o.initEvent("MeetRequest",!1,!1),o.binder_id=t.binder_id,e.dispatchEvent(o))},request_note:function(){var t;document.createEvent&&(t=document.createEvent("Event"),t.initEvent("NoteRequest",!1,!1),e.dispatchEvent(t))},error:function(t){var o;document.createEvent&&(o=document.createEvent("Event"),o.initEvent("ChatError",!1,!1),o.error_code=t.error_code,o.error_message=t.error_message,e.dispatchEvent(o))},iframe:s?!0:!1,_trigger:"button"})}),e.parentNode.insertBefore(nt,e)),"moxtra-chooser"===e.getAttribute("type")){var o=document.createElement("div");Moxtra._chooser=e,o.className="moxtra-chooser",e.style.display="none",Moxtra.addListener(o,"click",function(){Moxtra.binderChooser()}),e.parentNode.insertBefore(o,e)}else if("moxtra-pagechooser"===e.getAttribute("type")){var o=document.createElement("div");Moxtra._pageChooser=e,o.className="moxtra-pagechooser",e.style.display="none",Moxtra.addListener(o,"click",function(){Moxtra.pageChooser()}),e.parentNode.insertBefore(o,e)}if("moxtra-timeline"===e.getAttribute("type")){Moxtra._timeline=e;var n;n={c:0,i:0,o:0,s:0,m:0,q:0,d:Moxtra.baseUrl,n:5,g:60,w:760,h:500,r:0,init:function(e,t){var o=document;if(o.all&&"complete"!=o.readyState||!o.body)setTimeout(function(){n.init(e,t)},100);else{var r=window;r.addEventListener?r.addEventListener("keyup",n.esc_close):r.attachEvent("keyup",n.esc_close),n.c=o.createElement("DIV");var r=n.c,a="CSS1Compat"!=o.compatMode,a=/MSIE 6/i.test(navigator.userAgent)||/MSIE/i.test(navigator.userAgent)&&a?"absolute":"fixed";r.style.position=a,r.style.bottom="5px",r.style.right="5px",r.style.zIndex=2147483647,r.style.lineHeight="12px",e='<div style="position: absolute; bottom: '+n.g+'px; right: 0px; visibility: hidden; overflow: hidden; padding: 0px; height: 0;"><img src="'+n.d+'/api/images/logo-icon.png" style="cursor:pointer;position:absolute;top:0;left:0;border-style:solid;border-color: #00a2e8;border-radius: 5px;" onclick="window[ \'_mchat\' ].toggle(true);" /><div style="width:'+n.w+"px;height:"+n.h+'px;">'+e+'</div></div><div style="position: absolute; bottom: 0px; right: 0px; width: 45 px; height: 45 px; padding: 3px; cursor: pointer;" title="Click to toggle timeline" onmouseover="window[ \'_mchat\' ].stop();" onclick="window[ \'_mchat\' ].toggle();"><img src="'+n.d+'/api/images/logo.png" alt="Click to toggle timeline" style="max-width: none;border-style:solid;border-color: #00a2e8;border-radius: 5px;border-width: 1px;padding: 3px;width: 40px;height: 40px;"/>',t&&(e+='<div style="position: absolute; bottom: 32px; right: 3px; font: bold 14px arial; text-align:center;"><img src="'+n.d+'/api/images/mini_wait.gif"/></div>'),r.innerHTML=e+"</div>",o.body.appendChild(r),n.r=setInterval(n.query,5e3),n.start()}},start:function(){!n.q&&0<n.n--&&(n.s=5,n.m=30,n.i=setInterval(n.move,30))},stop:function(){n.q=1,n.c.style.bottom="5px",clearInterval(n.i)},move:function(){var e=n.c,t=parseInt(e.style.bottom)+n.s;t<n.m?t>5||(n.s=Math.abs(n.s)-1,0<(n.m-=4)||(clearInterval(n.i),setTimeout(n.start,2e3)),t=5):(t=n.m,n.s*=-1,n.s-=Math.abs(n.s)%2),e.style.bottom=t+"px"},toggle:function(e){clearInterval(n.o);var t=n.c.childNodes[0],o=-100;"hidden"==t.style.visibility&&1!=e&&(o*=-1,t.style.width="0px",t.style.height="0px",t.style.visibility="visible"),n.o=setInterval(function(){n.show(t,o)},1)},show:function(e,t){var o=e.offsetWidth+t,r=e.offsetHeight+t,a=0;r>=0||(r=0),o>=0||(o=0),0>o||0>r||(o>n.w?o=n.w:a=1,r>n.h?r=n.h:a=1,e.style.width=o+"px",e.style.height=r+"px"),a&&o>0&&r>0||(clearInterval(n.o),o<n.w?(e.style.visibility="hidden",e.style.padding="0"):e.style.padding="8px"),"hidden"==e.style.visibility&&(n.r=setInterval(n.query,1e3))},query:function(){try{jQuery.ajax({url:Moxtra.baseUrl+"/oauthapi/unreadfeed",dataType:"jsonp",success:function(e){e&&"ok"==e.status&&(clearInterval(n.r),n.r=setInterval(n.query,18e4)),n.c.lastChild.lastChild.innerHTML=e&&e.count?'<font color="white" style="background-color:red;border-radius: 100%;">'+e.count+"</font>":""},error:function(){clearInterval(n.r),n.c.lastChild.lastChild.innerHTML="",n.r=setInterval(n.query,1e4)}})}catch(e){}},esc_close:function(e){27==(e.keyCode||e.which)&&n.toggle(!0)}},window._mchat=n,n.init('<iframe id="_mchatf" src="'+Moxtra._SSOUrl(null,4)+'" frameborder="0" allowtransparency="true" allowfullscreen="true" style="width: 100%; height: 100%; overflow: scroll; background-color: transparent;"></iframe>',1)}if("moxtra-toolbar"===e.getAttribute("type")){Moxtra._toolbar=e;var n={c:0,i:0,o:0,s:0,m:0,q:0,d:Moxtra.baseUrl,n:5,g:60,w:760,h:500,r:0,init:function(e,t){var o=document;if(o.all&&"complete"!=o.readyState||!o.body)setTimeout(function(){n.init(e,t)},100);else{var r=window;r.addEventListener?r.addEventListener("keyup",n.esc_close):r.attachEvent("keyup",n.esc_close),n.c=o.createElement("DIV");var r=n.c;r.style.zIndex=2147483647,r.style.lineHeight="12px",e='<div style="position: absolute; bottom: '+n.g+'px; right: 0px; visibility: hidden; overflow: hidden; padding: 0px; height: 0;"><img src="'+n.d+'/api/images/logo-icon.png" style="cursor:pointer;position:absolute;top:0;left:0;border-style:solid;border-color: #00a2e8;border-radius: 5px;" onclick="window[ \'_mtool\' ].toggle(true);" /><div style="width:'+n.w+"px;height:"+n.h+'px;">'+e+'</div></div><div style="position: absolute; bottom: 0px; right: 0px; height: 60px; cursor: pointer; overflow:hidden; padding: 5px; background: #eee;"><div title="Start Meet" style="float:left; width: 45 px; height: 45 px; padding: 3px;" onmouseover="" onclick="return Moxtra.toolbar_startmeet();"><img src="'+n.d+'/api/images/meet.png" alt="Click to start Meet" style="max-width: none;border-style:solid;border-color: #00a2e8;border-radius: 5px;border-width: 1px;padding: 3px;width: 40px;height: 40px;"/></div><div title="Create Note" style="float:left; width: 45 px; height: 45 px; padding: 3px;" onmouseover="" onclick="return Moxtra.toolbar_startnote();"><img src="'+n.d+'/api/images/note.png" alt="Click to create Note"  style="max-width: none;border-style:solid;border-color: #00a2e8;border-radius: 5px;border-width: 1px;padding: 3px;width: 40px;height: 40px;"/></div><div title="Chat Now" style="float:left; width: 45 px; height: 45 px;padding:3px;" onmouseover="" onclick="return Moxtra.toolbar_startchat();"><img src="'+n.d+'/api/images/chat.png" alt="Click to join the conversation" style="max-width: none;border-style:solid;border-color: #00a2e8;border-radius: 5px;border-width: 1px;padding: 3px;width: 40px;height: 40px;"/></div><div title="Click to toggle timeline" style="float:left; width: 45 px; height: 45 px;padding:3px;" onmouseover="window[ \'_mtool\' ].stop();" onclick="window[ \'_mtool\' ].toggle();"><img src="'+n.d+'/api/images/logo.png" alt="Click to toggle timeline" style="max-width: none;border-style:solid;border-color: #00a2e8;border-radius: 5px;border-width: 1px;padding: 3px;width: 40px;height: 40px;"/>',t&&(e+='<div style="position: absolute; bottom: 45px; right: 3px; font: bold 14px arial; text-align:center;"><img src="'+n.d+'/api/images/mini_wait.gif"/></div>'),r.innerHTML=e+"</div></div>",o.body.appendChild(r),n.r=setInterval(n.query,5e3)}},start:function(){},stop:function(){n.q=1,n.c.style.bottom="5px",clearInterval(n.i)},toggle:function(e){clearInterval(n.o);var t=n.c.childNodes[0],o=-100;"hidden"==t.style.visibility&&1!=e&&(o*=-1,t.style.width="0px",t.style.height="0px",t.style.visibility="visible"),n.o=setInterval(function(){n.show(t,o)},1)},show:function(e,t){var o=e.offsetWidth+t,r=e.offsetHeight+t,a=0;r>=0||(r=0),o>=0||(o=0),0>o||0>r||(o>n.w?o=n.w:a=1,r>n.h?r=n.h:a=1,e.style.width=o+"px",e.style.height=r+"px"),a&&o>0&&r>0||(clearInterval(n.o),o<n.w?(e.style.visibility="hidden",e.style.padding="0"):e.style.padding="8px"),"hidden"==e.style.visibility&&(n.r=setInterval(n.query,2e3))},query:function(){try{jQuery.ajax({url:Moxtra.baseUrl+"/oauthapi/unreadfeed",dataType:"jsonp",success:function(e){e&&"ok"==e.status?(clearInterval(n.r),n.r=setInterval(n.query,18e4),Moxtra._barlogin=!0):Moxtra._barlogin=!1,n.c.lastChild.lastChild.lastChild.innerHTML=e&&e.count?'<font color="white" style="background-color:red;border-radius: 100%;">'+e.count+"</font>":""},error:function(){clearInterval(n.r),n.c.lastChild.lastChild.lastChild.innerHTML="",n.r=setInterval(n.query,1e4),Moxtra._barlogin=!1}})}catch(e){}},esc_close:function(e){27==(e.keyCode||e.which)&&n.toggle(!0)}};window._mtool=n,n.init('<iframe id="_mtoolf" src="'+Moxtra._SSOUrl(null,4)+'" frameborder="0" allowtransparency="true" allowfullscreen="true" style="width: 100%; height: 100%; overflow: scroll; background-color: transparent;"></iframe>',1)}},m=0,l=o.length;l>m;m++)t=o[m],n(t);v&&(a?eventFire(a,"click"):Moxtra.meet(v)),f&&(d?eventFire(d,"click"):Moxtra.note(f)),M&&Moxtra.video(M);var h=Moxtra_Session.get("meet_endurl");h&&Moxtra.endMeet(h)},"complete"===document.readyState?setTimeout(e,0):document.addEventListener?document.addEventListener("DOMContentLoaded",e,!1):document.attachEvent("onreadystatechange",e)}();